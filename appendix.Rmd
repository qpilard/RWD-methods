# **Appendix 1:** R code of the simulated dataset {.unnumbered #r-code-simu}

This is the R code to reproduce the motivating example:

```{r simulation}
set.seed(42)  # Set seed for reproducibility

# Parameters
N <- 575  # Number of patients

# Generate ID
ID <- 1:N

# Generate age at diagnosis (18 to 80 years)
AGE <- sample(18:80, N, replace = TRUE)

# Generate gender (0 = Male, 1 = Female)
GENDER <- sample(0:1, N, replace = TRUE)

# Generate Beck Depression Inventory score at diagnosis (0 to 63)
BECK <- sample(0:63, N, replace = TRUE)

# Generate socioeconomic status (1 to 5)
SOCIO_ECO <- sample(1:5, N, replace = TRUE)

# Generate treatment initiated at diagnosis (0 = Sertralex, 1 = Duloxyn)
TREAT <- sample(0:1, N, replace = TRUE)

# Generate switch variable (0 = No switch, 1 = Switched)
# Assume 30% of patients switch treatments
SWITCH <- sample(0:1, N, replace = TRUE, prob = c(0.7, 0.3))

# Generate time to switch for those who switched (1 to 365 days)
TIME_TO_SWITCH <- ifelse(SWITCH == 1, sample(1:365, sum(SWITCH), replace = TRUE), NA)

# Generate follow-up time (1 to 365 days)
# Patients who switch will be censored at the time of switch
FOLLOW_UP_TIME <- ifelse(SWITCH == 0, sample(1:365, N, replace = TRUE), TIME_TO_SWITCH)

# Generate relapse indicator (0 = No relapse, 1 = Relapse)
# Assume a higher probability of relapse for those who switched treatments
EVENT <- numeric(N)
for (i in 1:N) {
  if (SWITCH[i] == 1) {
    EVENT[i] <- rbinom(1, 1, 0.6)  # 60% relapse chance if switched
  } else {
    EVENT[i] <- rbinom(1, 1, 0.4)  # 40% relapse chance if not switched
  }
}

# Create the final dataset
df <- data.frame(ID, 
                 AGE, 
                 GENDER, 
                 BECK, 
                 SOCIO_ECO, 
                 EVENT, 
                 FOLLOW_UP_TIME, 
                 TREAT, 
                 SWITCH, 
                 TIME_TO_SWITCH)
```