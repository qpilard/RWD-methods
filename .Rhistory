# Create survey object weighted with ATE weights
data_selected <- data %>% select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
library(survey)
#Unweighted table
tbl_unweighted <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**", estimate ~ "**SMD**", stat_1 ~ "**Sertralex**", stat_2 ~ "**Duloxyn**")
tbl_unweighted
# Calculate weights
W <- weightit(TREAT0 ~ AGE + GENDER + SOCIO_ECO + BECK0, data = data, method = "glm", estimand = "ATE")
# Create survey object weighted with ATE weights
data_selected <- data %>% select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
#Weighted table
tbl_weighted <- data_svy %>%
tbl_svysummary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**", estimate ~ "**SMD**", stat_1 ~ "**Sertralex**", stat_2 ~ "**Duloxyn**")
tbl_weighted
tbl_weighted$table_body
tbl_unweighted$table_body
tbl_merge(
tbls = list(tbl_unweighted, tbl_weighted),
tab_spanner = c("**Unweighted**", "**Weighted**")
)
tbl_unweighted_body <- tbl_unweighted$table_body
tbl_weighted_body <- tbl_weighted$table_body
# S'assurer que les colonnes ont le même type
tbl_weighted_body <- tbl_weighted_body %>%
mutate(across(where(is.integer), as.double))
tbl_combined <- tbl_merge(
tbls = list(tbl_unweighted, tbl_weighted),
tab_spanner = c("**Unweighted**", "**Weighted**")
)
# S'assurer que les colonnes ont le même type
tbl_weighted$table_body <- tbl_weighted$table_body %>%
mutate(across(where(is.integer), as.double)) # Convertir les entiers en doubles
# Vérification des colonnes pour s'assurer qu'elles correspondent
tbl_unweighted_body <- tbl_unweighted$table_body
tbl_weighted_body <- tbl_weighted$table_body
tbl_merge(
tbls = list(tbl_unweighted, tbl_weighted),
tab_spanner = c("**Unweighted**", "**Weighted**")
)
tbl_merge(
tbls = list(tbl_unweighted_body , tbl_weighted_body ),
tab_spanner = c("**Unweighted**", "**Weighted**")
)
#Unweighted table
tbl_unweighted <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**", estimate ~ "**SMD**", stat_1 ~ "**Sertralex**", stat_2 ~ "**Duloxyn**")
# Calculate weights
W <- weightit(TREAT0 ~ AGE + GENDER + SOCIO_ECO + BECK0, data = data, method = "glm", estimand = "ATE")
# Create survey object weighted with ATE weights
data_selected <- data %>% select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
#Weighted table
tbl_weighted <- data_svy %>%
tbl_svysummary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**", estimate ~ "**SMD**", stat_1 ~ "**Sertralex**", stat_2 ~ "**Duloxyn**")
tbl_weighted
tbl_merge(
tbls = list(tbl_unweighted , tbl_weighted)
)
print(sapply(tbl_unweighted$table_body, class))
print(sapply(tbl_weighted$table_body, class))
print(names(tbl_unweighted$table_body))
print(names(tbl_weighted$table_body))
print(head(tbl_unweighted$table_body))
print(head(tbl_weighted$table_body))
tbl_unweighted$table_body <- tbl_unweighted$table_body %>%
select(all_of(names(tbl_weighted$table_body)))
tbl_combined <- tbl_merge(
tbls = list(tbl_unweighted, tbl_weighted),
tab_spanner = c("**Unweighted**", "**Weighted**"),
by = "label"  # Ajoutez ceci pour vous assurer que la fusion se fait sur la colonne appropriée
)
combined_df <- dplyr::bind_rows(df_unweighted, df_weighted)
#Unweighted table
tbl_unweighted <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**", estimate ~ "**SMD**", stat_1 ~ "**Sertralex**", stat_2 ~ "**Duloxyn**")
# Convertir les tableaux gtsummary en data frames
df_unweighted <- tbl_unweighted$table_body %>%
as.data.frame() %>%
mutate(Type = "Unweighted")  # Ajouter une colonne pour indiquer le type
# Calculate weights
W <- weightit(TREAT0 ~ AGE + GENDER + SOCIO_ECO + BECK0, data = data, method = "glm", estimand = "ATE")
# Create survey object weighted with ATE weights
data_selected <- data %>% select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
#Weighted table
tbl_weighted <- data_svy %>%
tbl_svysummary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**", estimate ~ "**SMD**", stat_1 ~ "**Sertralex**", stat_2 ~ "**Duloxyn**")
df_weighted <- tbl_weighted$table_body %>%
as.data.frame() %>%
mutate(Type = "Weighted")  # Ajouter une colonne pour indiquer le type
# Fusionner les deux data frames
combined_df <- dplyr::bind_rows(df_unweighted, df_weighted)
tbl_combined <- combined_df %>%
tbl_summary(by = Type)
combined_df
combined_df %>%
tbl_summary(by = Type,
statistic = list(all_continuous() ~ "{mean} ({sd})"))
combined_df
W <- weightit(TREAT0 ~ AGE + GENDER + SOCIO_ECO + BECK0,
data = data,
method = "glm",
estimand = "ATE")
W$weights
data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_svy
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
t2
t1$table_body
t2$table_body
merged_table <- tbl_stack(list(t1, t2),
labels = c("Before Weighting", "After Weighting"))
merged_table <- tbl_stack(list(t1, t2))
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
merged_table <- tbl_stack(list(t1, t2))
t1$table_body
t2$table_body
merged_table
merged_table <- tbl_merge(list(t1, t2))
merged_table <- tbl_stack(list(t1, t2))
merged_table
?tbl_stack()
merged_table <- tbl_stack(list(t1, t2), group_header = c("Unadjusted Analysis", "Adjusted Analysis"))
merged_table
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
merged_table <- tbl_stack(list(t1, t2), group_header = c("***Unweighted**", "**Weighted**"))
?tbl_stack()
t1$table_body
t2$table_body
merged_table
?tbl_stack()
t2
merged_table <- tbl_merge(list(t1, t2), group_header = c("Unweighted**", "Weighted"))
merged_table <- tbl_merge(list(t1, t2))
data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
list(t1, t2)
merged_table <- tbl_merge(list(t1, t2))
t2$modify_stat_N
str(t2)
merged_table
merged_table
merged_table <- tbl_merge(list(t1, t2))
rlang::last_trace()
for (int_col in c("modify_stat_N", "modify_stat_n")) {
t1$table_styling$header[[int_col]] <-
t1$table_styling$header[[int_col]] |> as.numeric()
}
merged_table <- tbl_merge(list(t1, t2))
merged_table
?tbl_merge
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
for (int_col in c("modify_stat_N", "modify_stat_n")) {
t1$table_styling$header[[int_col]] <-
t1$table_styling$header[[int_col]] |> as.numeric()
}
merged_table <- tbl_merge(tbls = list(t1, t2),
tab_spanner = c("**Unweighted**", "**Weighted**"))
merged_table
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
for (int_col in c("modify_stat_N", "modify_stat_n")) {
t1$table_styling$header[[int_col]] <-
t1$table_styling$header[[int_col]] |> as.numeric()
}
merged_table <- tbl_merge(tbls = list(t1, t2),
tab_spanner = c("**Unweighted**", "**Weighted**"))
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
for (int_col in c("modify_stat_N", "modify_stat_n")) {
t1$table_styling$header[[int_col]] <-
t1$table_styling$header[[int_col]] |> as.numeric()
}
merged_table <- tbl_merge(tbls = list(t1, t2),
tab_spanner = c("**Unweighted**", "**Weighted**")) %>%
modify_table_body(~ .x %>% select(-conf.low)) %>%
merged_table
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
for (int_col in c("modify_stat_N", "modify_stat_n")) {
t1$table_styling$header[[int_col]] <-
t1$table_styling$header[[int_col]] |> as.numeric()
}
merged_table <- tbl_merge(tbls = list(t1, t2),
tab_spanner = c("**Unweighted**", "**Weighted**")) %>%
modify_table_body(~ .x %>% select(-conf.low))
merged_table$table_body
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
for (int_col in c("modify_stat_N", "modify_stat_n")) {
t1$table_styling$header[[int_col]] <-
t1$table_styling$header[[int_col]] |> as.numeric()
}
merged_table <- tbl_merge(tbls = list(t1, t2),
tab_spanner = c("**Unweighted**", "**Weighted**")) %>%
modify_table_body(~ .x %>% select(-conf.low_1, conf.low_2))
merged_table$table_body
merged_table
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
for (int_col in c("modify_stat_N", "modify_stat_n")) {
t1$table_styling$header[[int_col]] <-
t1$table_styling$header[[int_col]] |> as.numeric()
}
merged_table <- tbl_merge(tbls = list(t1, t2),
tab_spanner = c("**Unweighted**", "**Weighted**")) %>%
modify_table_body(~ .x %>% select(-conf.low_1, -conf.low_2))
merged_table$table_body
merged_table
t1 <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0) %>%
tbl_summary(by = TREAT0, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
data_selected <- data %>%
select(AGE, GENDER, SOCIO_ECO, BECK0, TREAT0)
#After weighting
data_svy <- svydesign(ids = ~1, data = data_selected, weights = ~W$weights)
t2 <- data_svy %>%
tbl_svysummary(by = TREAT0,
statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
add_difference(test = everything() ~ "smd") %>%
add_overall() %>%
modify_header(label ~ "**Variable**",
estimate ~ "**SMD**",
stat_0 ~ "**Total**",
stat_1 ~ "**Sertralex**",
stat_2 ~ "**Duloxyn**")
for (int_col in c("modify_stat_N", "modify_stat_n")) {
t1$table_styling$header[[int_col]] <-
t1$table_styling$header[[int_col]] |> as.numeric()
}
merged_table <- tbl_merge(tbls = list(t1, t2),
tab_spanner = c("**Unweighted**", "**Weighted**")) %>%
modify_table_body(~ .x %>% select(-conf.low_1, -conf.low_2))
merged_table$table_body
merged_table
weighted <- coxph(Surv(TIME_TO_EVENT, EVENT)~TREAT0+BECK0, weights = weights, data = data) %>%
tbl_regression(model, exponentiate = TRUE)
sum(W$weights)
ESS(W)
ESS(w)
ESS(w$weights)
ESS(W$weights)
