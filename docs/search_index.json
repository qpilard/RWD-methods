[["index.html", "Methods for the analysis of Real World Data Welcome", " Methods for the analysis of Real World Data Quentin Pilard 2024-12-03 Welcome This book provides a hands-on guide to analyzing Real World Data (RWD) using a motivating example and R code. This book begins with Chapter 1, which offers an overview of RWD, highlighting key concepts and the challenges commonly encountered in this field. Following this, a motivating example is introduced in Chapter 2, which will be used throughout the book to illustrate each subsequent chapter with practical R code for reproducibility (used packages are listed in Appendix A). The next chapters focus on approaches to limit these inherent biases: Chapter 3 presents the Hernán et al. framework, a key approach to Target Trial Emulation (TTE) that strengthens the reliability of Real World Evidence (RWE) to address inherent biases. Chapter 4 focuses on Propensity Score (PS) techniques aiming to reduce confounding bias at baseline. Chapter 5 examines the Clone-Censor-Weight (CCW) approach, a method to limit both confounding and immortal bias in the context of time-varying treatments. "],["author.html", "About the author", " About the author Quentin Pilard (pilard.quentin@gmail.com) This tutorial is based on my four years of experience at Quinten Health (Paris) working with RWD in collaboration with pharmaceutical industries and academia "],["introduction.html", "Chapter 1 Introduction 1.1 Definition 1.2 Use of RWD in drug development 1.3 Regulators acceptance of RWD 1.4 Use of External Control Arm and Target Trial Emulation 1.5 Main biases in RWD", " Chapter 1 Introduction 1.1 Definition According to the main regulatory agencies, these are the definition of RWD and RWE (Baumfeld Andre et al. 2020): Regulatory agency Real-World Data Real-World Evidence FDA (USA) Data relating to patient health status and/or the delivery of health care routinely collected from a variety of sources Clinical evidence about the usage and potential benefits or risks of a medical product derived from analysis of RWD EMA (Europe) Health care related data that is collected outside of randomized clinical trials Evidence coming from registries, electronic health records, and insurance data PMDA (Japan) Utilization of patient registry data and medical information database No definition was found As presented, definitions are fairly consistent with each other. 1.2 Use of RWD in drug development In drug development, RWD has traditionally been used in post-market safety surveillance. However, its potential applications extend throughout the entire drug lifecycle (Khosla et al. 2018). This includes: Discovery and Early Development: Purpose: Characterize disease epidemiology and unmet needs. RWE Use: Helps define the target product profile by analyzing disease burden and patient characteristics, guiding the selection of indications and prioritizing development. Phase 1–3 Clinical Trials: Purpose: Design clinical trials and ensure they reflect real-world populations. RWE Use: Provides insights into real-world patient populations and treatment patterns, helping to refine inclusion/exclusion criteria and improve the external validity of trials. Regulatory Approval: Purpose: Obtain marketing authorization for new drugs. RWE Use: Supports clinical trial data by providing additional evidence on real-world safety, efficacy, and patient outcomes, potentially accelerating approval processes. Post-Approval (Phase 4) and Market Access: Purpose: Ensure broad access and reimbursement. RWE Use: Provides evidence on the real-world effectiveness, safety, and cost-effectiveness of the drug compared to standard care, supporting reimbursement decisions and market access strategies. Post-Market Surveillance and Lifecycle Management: Purpose: Monitor long-term safety and maintain market access. RWE Use: Continuously tracks patient outcomes, adherence, and safety data in real-world settings, supporting the long-term value demonstration and label expansion into new populations or indications. 1.3 Regulators acceptance of RWD RWD is gaining increasing interest and acceptance from regulators as a complement to clinical trial findings. For example, various frameworks have been established, such as the “Real-World Evidence Framework to Support EU Regulatory Decision-Making” by the EMA and the “Real-World Evidence Program” by the FDA (EMA 2023; FDA 2018). Additionally, the FDA has issued guidance for industry titled “Considerations for the Use of Real-World Data and Real-World Evidence to Support Regulatory Decision-Making for Drug and Biological Products” (FDA 2023). Moreover, FDA-funded initiative like the DUPLICATE program have been undertaken. This program focuses on replicating large-scale Randomized Controlled Trials (RCTs) using RWD to evaluate the reliability and confidence in analyses based on RWE (Franklin et al. 2021). 1.4 Use of External Control Arm and Target Trial Emulation While RCTs remain the gold standard for generating unbiased evidence due to their controlled and randomized nature, there are situations where a traditional control group is not available or feasible. In such cases, researchers can resort to two alternative approaches: External Control Arm (ECA) or the Target Trial Emulation (TTE) (Baumfeld Andre et al. 2020; Hernán and Robins 2016). These two methods are illustrated below: FIGURE 1.1: Main study designs using RWD The ECA method involves using historical or real-world data as a comparative baseline, offering a way to evaluate the effectiveness of a treatment in the absence of a control group. Alternatively, the TTE seeks to replicate the design of an RCT as closely as possible, but within the context of RWD. 1.5 Main biases in RWD Although ECA and TTE are viable alternatives to RCT, they come with inherent risks of bias due to the lack of randomization. This includes: selection bias, which arises from non-random selection of treatment groups; measurement bias, resulting from inaccuracies in data collection; confounding bias, where external factors influence both treatment and outcome; information bias, stemming from differences in data quality between groups; and immortal time bias, which occurs when there are differences in observation periods for the treatment groups. "],["motivating-example.html", "Chapter 2 Motivating example", " Chapter 2 Motivating example Persistent Depressive Disorder (PDD) is a chronic mood disorder characterized by a consistently low mood that lasts for at least two years, significantly impacting patients’ quality of life. Antidepressants serve as the primary treatment for PDD, aiding in symptom management and reducing the risk of relapse. Among these medications, Sertralex and Duloxyn are frequently prescribed, each operating through distinct mechanisms. This study aims to compare the effectiveness of Sertralex and Duloxyn in prolonging the time to relapse over a maximum follow-up period of one year, representing the typical treatment duration for patients newly diagnosed with PDD. To capture different clinical settings, we consider two scenarios: Scenario 1: In this simplified setup, treatment with Sertralex or Duloxyn begins immediately following the PDD diagnosis. Scenario 2: In a more realistic setup, a 30-day “grace period” is introduced—a period following PDD diagnosis during which treatment initiation can occur. This grace period reflects common clinical practice, as clinicians may not always recommend immediate drug therapy after diagnosis. Here is the list of variables included in the dataset: ID: Patient identifier AGE: Age at diagnosis (years) GENDER: Gender of the patient [0=Male; 1=Female] BECK: Beck Depression Inventory score at diagnosis [0 (best prognosis) - 63 (worst prognosis)] SOCIO_ECO: Socioeconomic status [1=Very low; 2=Low; 3=Moderate; 4=High; 5=Very high] EVENT: Relapse indicator [0=No relapse; 1=Relapse] TIME_TO_EVENT: Time from diagnosis to event of interest or censoring (in days) TREAT: Therapy initiated at diagnosis [0=Sertralex; 1=Duloxyn]. TIME_TO_TREAT: Time from diagnosis to treatment (in days) Further information on the simulation process to generate these data are described in Appendix B. "],["target-trial-emulation.html", "Chapter 3 Target Trial Emulation using observational data 3.1 Background 3.2 Specify the target trial 3.3 Emulate the target trial", " Chapter 3 Target Trial Emulation using observational data 3.1 Background In 2016, Hernán and Rubins presented a framework to emulate a clinical trial using observational data when no clinical trial exists (Hernán and Robins 2016).The latter is a 2-step process: (1) Specifying the target trial (i.e., which is the hypothetical trial that could have been performed to answer the research question). This includes these elements eligibility criteria, treatment strategies, assignment procedures, follow-up period, outcome, causal contrast of interest and analysis plan, and (2) Emulating each element from the target trial. Let us illustrate the TTE framework using our motivating example. 3.2 Specify the target trial As suggested, we specified the target trial as below: Protocol component Target trial emulation Eligibility criteria Individuals aged 18 or older, newly diagnosed with PDD. Treatment strategies Individuals who initiated Sertralex or Duloxyn. Assignment procedures Individuals randomly assigned to either strategy at baseline and are not aware of the assigned strategy Follow-up period Starts at randomization and ends at the first occurrence of a relapse event, death, or after one year of follow-up, whichever occurs first. Outcome Relapse (defined as a recurrence of depressive disorder) diagnosed by a clinician, identified through clinical assessment or documented diagnosis of depression during the follow-up period. Causal contrasts of interest Intention-to-treat (ITT): Effect of being assigned to treatment strategies at randomization, regardless of whether individuals adhere to them during follow-up. Per Protocol (PP): Individuals who discontinued treatment during follow-up were right censored at the first occurence. (see Appendix C for causal contrasts of interest defined as formulated in the ICH E9 (R1) addendum) Analysis plan In both analyses (ITT and PP), Kaplan-Meier estimates and Cox proportional hazards models were utilized to compare the time to relapse from randomization between Sertralex and Duloxyn | | To estimate the validity of PP, adjustment for post randomization confunding is anticipated using Inverse Probability of Censoring Weighted (IPCW) methods (Robins and Finkelstein 2000) 3.3 Emulate the target trial Next, we examined each component and detailed how they can be derived using RWD. Eligibility criteria: We included individuals aged 18 or older who were firstly diagnosed with PDD. Treatment strategies: We defined two treatment strategies: either Sertralex or Duloxyn as the first prescription following a PDD diagnosis. In scenario 1 (see Chapter 2), this is considered as immediate, while in scenario 2, we allowed a period of up to 30 days to record the first initiation. Assignment procedures: We assumed these two groups were exchangeable at the date of PDD diagnosis (or up to 30 days following PDD diagnosis for scenario 2), conditionally on baseline covariates: Age, gender, Beck score and socioeconomic status. Follow-up periods: We defined time zero as the date of PDD diagnosis. From this point, we followed-up individuals until the earliest of the following events: first clinical relapse, loss of follow-up (corresponds to the last activity record in the database), 365 days after time zero. Outcomes: We assumed the outcome as the first relapse occurring after time zero. Causal contrast of interest: We considered observational analogues of the ITT and PP effect. However, the ITT effect in the emulated trial is closer to a PP effect, as we lack information on treatment discontinuation, and thus assumed full adherence throughout the study. Analysis plan: In scenario 1, we used Inverse Probability Treatment Weights (IPTW) to emulate the randomization process and applied these weights in the outcome analysis, including weighted Kaplan-Meier estimates and Cox proportional hazards models (see Chapter 4 for further details). In scenario 2, we implemented the Clone-Censor-Weight method (CCW) to address both confounding and immortal time bias due to the permitted delay between PDD diagnosis and treatment initiation (see Chapter 5 for further details). "],["iptw-application.html", "Chapter 4 Propensity score methods 4.1 Background 4.2 Identify confounders 4.3 IPTW implementation 4.4 Balance Diagnostics 4.5 Outcome analysis", " Chapter 4 Propensity score methods 4.1 Background The Propensity Score (PS) is utilized to emulate the randomization process, with the goal of balancing the population’s characteristics across the groups of interest. Unlike multivariable regression, which focuses on estimating the effect at the individual level (subject-specific effect), the PS method estimates the effect at the population level (population-average effect). In the context of models with a non-linear link (typically when Odds Ratio [OR] or Hazard Ratio [HR] are reported), these two effects differ (Austin et al. 2007). Statistically, the PS is defined as the conditional probability of receiving the exposure of interest based on observed baseline characteristics. It is typically estimated using multivariable logistic regression, where the exposure of interest serves as the dependent variable and the baseline characteristics act as independent variables. Once calculated, it can be employed in various approaches, including matching, stratification, Inverse Probability of Treatment Weighting (IPTW), and covariate adjustment (Austin 2011). The scenario 1 discussed in Chapter 2 will be applied to illustrate the application of IPTW. 4.2 Identify confounders The baseline characteristics incorporated in the logistic regression must be defined as confounders - variables that influence both treatment assignment and the outcome without being part on the causal pathway. Other types of variables, such as mediators or colliders, may also be present; however, adjusting for these can introduce bias (MacKinnon and Lamp 2021). Directed Acyclic Graphs (DAGs) are usually recommended to depict causal relationships, ideally, clinical experts should be involved in their development as they more likely to know involved clinical pathways, interacting with the disease of interest (Hernan and Robins 2024; Tennant et al. 2021). DAGs can be created using the DAGitty website or dagitty R package. In our example, we identified age at diagnosis, gender, Beck score and socioeconomic status as potential confounders of the association between treatment exposure and relapse. The associated DAG is represented in Appendix D. 4.3 IPTW implementation This code implements the IPTW approach using the stabilized Average Treatment Effect (ATE) estimand (Austin and Stuart 2015), detailed in the following equation: \\[ IPTW_{Stabilized, ATE} = \\frac{X*Pr(X=1)}{e}+\\frac{(1-X)*Pr(X=0)}{1-e} \\] Here, the PS is defined as \\(e = \\Pr ({X}=1|{Z}={z})\\) and \\(X\\) and \\(Z\\) are the treatment status (0 = Sertralex and 1 = Duloxyn) and observed confunders (gender, age, SES level, and Beck score), respectively. This models the treatment effect across the entire population likely to receive either Sertralex or Duloxyn. Additional details on causal estimands (ATE/ATT) are provided in Appendix E. #Perform weighting W &lt;- WeightIt::weightit(TREAT ~ AGE + GENDER + SOCIO_ECO + BECK, data = data, method = &quot;glm&quot;, estimand = &quot;ATE&quot;, stabilize = TRUE) data$weights &lt;- W$weights data$ps &lt;- W$ps 4.4 Balance Diagnostics To evaluate balance after weighting, we applied the typical recommendation by using the Standardized Mean Difference (SMD) and checking whether the difference in SMD is less than 0.1 (Austin 2009; Normand et al. 2001). A difference below this threshold indicates that the characteristics of interest are balanced between the groups. love.plot(W, binary = &quot;std&quot;, thresholds = c(m = .1), sample.names = c(&quot;Before weighting&quot;, &quot;After weighting&quot;)) To summarize, a table before and after weighting is also represented according to treatment status. #Before weighting t1 &lt;- data %&gt;% select(AGE, GENDER, SOCIO_ECO, BECK, TREAT) %&gt;% tbl_summary(by = TREAT, statistic = list(all_continuous() ~ &quot;{mean} ({sd})&quot;), label = list(AGE ~ &quot;Age (at diagnosis)&quot;, GENDER ~ &quot;Gender&quot;, SOCIO_ECO ~ &quot;SES level (1-5)&quot;, BECK ~ &quot;Beck score (0-63)&quot;), digits = all_continuous() ~ 1) %&gt;% add_difference(test = everything() ~ &quot;smd&quot;) %&gt;% modify_header(label ~ &quot;**Variable**&quot;, estimate ~ &quot;**SMD**&quot;, stat_1 ~ paste0(&quot;**Sertralex (N=&quot;,nrow(data[which(data$TREAT==&quot;Sertralex&quot;),]),&quot;)**&quot;), stat_2 ~ paste0(&quot;**Duloxyn (N=&quot;,nrow(data[which(data$TREAT==&quot;Duloxyn&quot;),]),&quot;)**&quot;)) data_selected &lt;- data %&gt;% select(AGE, GENDER, SOCIO_ECO, BECK, TREAT) #After weighting data_svy &lt;- svydesign(ids = ~1, data = data_selected, weights = ~W$weights) t2 &lt;- data_svy %&gt;% tbl_svysummary(by = TREAT, statistic = list(all_continuous() ~ &quot;{mean} ({sd})&quot;), label = list(AGE ~ &quot;Age (at diagnosis)&quot;, GENDER ~ &quot;Gender&quot;, SOCIO_ECO ~ &quot;SES level (1-5)&quot;, BECK ~ &quot;Beck score (0-63)&quot;), digits = all_continuous() ~ 1) %&gt;% add_difference(test = everything() ~ &quot;smd&quot;) %&gt;% modify_header(label ~ &quot;**Variable**&quot;, estimate ~ &quot;**SMD**&quot;, stat_1 ~ paste0(&quot;**Sertralex (N=&quot;,round(ESS(W$weights[W$treat==&quot;Sertralex&quot;]),0),&quot;)**&quot;), stat_2 ~ paste0(&quot;**Duloxyn (N=&quot;,round(ESS(W$weights[W$treat==&quot;Duloxyn&quot;]),0),&quot;)**&quot;)) for (int_col in c(&quot;modify_stat_N&quot;, &quot;modify_stat_n&quot;)) { t1$table_styling$header[[int_col]] &lt;- t1$table_styling$header[[int_col]] |&gt; as.numeric() } tbl_merge(tbls = list(t1, t2), tab_spanner = c( paste0(&quot;**Raw (N=&quot;,nrow(data),&quot;)**&quot;), paste0(&quot;**Weighted (ESS=&quot;,round(ESS(W$weights),0),&quot;)**&quot;) ) )%&gt;% modify_table_body(~ .x %&gt;% select(-conf.low_1, -conf.low_2)) #vkyzfdndpd table { font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } #vkyzfdndpd thead, #vkyzfdndpd tbody, #vkyzfdndpd tfoot, #vkyzfdndpd tr, #vkyzfdndpd td, #vkyzfdndpd th { border-style: none; } #vkyzfdndpd p { margin: 0; padding: 0; } #vkyzfdndpd .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #vkyzfdndpd .gt_caption { padding-top: 4px; padding-bottom: 4px; } #vkyzfdndpd .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #vkyzfdndpd .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #vkyzfdndpd .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vkyzfdndpd .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vkyzfdndpd .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vkyzfdndpd .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #vkyzfdndpd .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #vkyzfdndpd .gt_column_spanner_outer:first-child { padding-left: 0; } #vkyzfdndpd .gt_column_spanner_outer:last-child { padding-right: 0; } #vkyzfdndpd .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #vkyzfdndpd .gt_spanner_row { border-bottom-style: hidden; } #vkyzfdndpd .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #vkyzfdndpd .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #vkyzfdndpd .gt_from_md > :first-child { margin-top: 0; } #vkyzfdndpd .gt_from_md > :last-child { margin-bottom: 0; } #vkyzfdndpd .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #vkyzfdndpd .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #vkyzfdndpd .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #vkyzfdndpd .gt_row_group_first td { border-top-width: 2px; } #vkyzfdndpd .gt_row_group_first th { border-top-width: 2px; } #vkyzfdndpd .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vkyzfdndpd .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #vkyzfdndpd .gt_first_summary_row.thick { border-top-width: 2px; } #vkyzfdndpd .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vkyzfdndpd .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vkyzfdndpd .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #vkyzfdndpd .gt_last_grand_summary_row_top { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; } #vkyzfdndpd .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #vkyzfdndpd .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vkyzfdndpd .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vkyzfdndpd .gt_footnote { margin: 0px; font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #vkyzfdndpd .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vkyzfdndpd .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #vkyzfdndpd .gt_left { text-align: left; } #vkyzfdndpd .gt_center { text-align: center; } #vkyzfdndpd .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #vkyzfdndpd .gt_font_normal { font-weight: normal; } #vkyzfdndpd .gt_font_bold { font-weight: bold; } #vkyzfdndpd .gt_font_italic { font-style: italic; } #vkyzfdndpd .gt_super { font-size: 65%; } #vkyzfdndpd .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; } #vkyzfdndpd .gt_asterisk { font-size: 100%; vertical-align: 0; } #vkyzfdndpd .gt_indent_1 { text-indent: 5px; } #vkyzfdndpd .gt_indent_2 { text-indent: 10px; } #vkyzfdndpd .gt_indent_3 { text-indent: 15px; } #vkyzfdndpd .gt_indent_4 { text-indent: 20px; } #vkyzfdndpd .gt_indent_5 { text-indent: 25px; } #vkyzfdndpd .katex-display { display: inline-flex !important; margin-bottom: 0.75em !important; } #vkyzfdndpd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after { height: 0px !important; } Variable Raw (N=508) Weighted (ESS=468) Sertralex (N=299)1 Duloxyn (N=209)1 SMD2 Duloxyn (N=188)1 Sertralex (N=281)1 SMD2 Age (at diagnosis) 32.5 (6.0) 31.9 (5.7) 0.12 32.1 (6.2) 32.0 (5.7) 0.01 Gender 0.32 0.00     Male 142 (47%) 132 (63%) 164 (54%) 113 (55%)     Female 157 (53%) 77 (37%) 137 (46%) 94 (45%) SES level (1-5) 0.24 0.02     Very low 59 (20%) 47 (22%) 66 (22%) 46 (22%)     Low 58 (19%) 35 (17%) 55 (18%) 39 (19%)     Moderate 67 (22%) 32 (15%) 59 (19%) 39 (19%)     High 62 (21%) 44 (21%) 61 (20%) 40 (19%)     Very high 53 (18%) 51 (24%) 61 (20%) 42 (20%) Beck score (0-63) 25.3 (7.5) 27.8 (6.4) -0.37 26.5 (7.5) 26.6 (6.9) -0.01 1 Mean (SD); n (%) 2 Standardized Mean Difference After weighting, observed confunders were above the recommended threshold. If, after weighting, the observed confounders exceed the recommended threshold, the model can be respecified (e.g. making a continuous variable categorical or dichotomous, including higher order terms or splines of variables, …). Otherwise, variables with remaining imbalance should ideally be adjusted for when modeling the final outcome, using a doubly robust approach (i.e., adjusting for confounders in both the treatment and outcome models) (Funk et al. 2011; Garrido et al. 2014). Next, to ensure that the positivity assumption is met, we plotted the propensity score distributions to assess the degree of overlap between individuals receiving Sertralex and Duloxyn. Our goal is to establish sufficient common support, meaning all subjects have a non-zero probability of receiving either treatment. #Display PS plot1&lt;-ggplot2::ggplot(data, mapping = aes(x = ps))+ ggplot2::geom_density(colour=&quot;red&quot;)+ ggplot2::geom_density(mapping=aes(group = TREAT, fill = TREAT),alpha=0.4)+ ggtitle(&quot;Raw&quot;)+ scale_fill_manual(name=&quot;Treatment&quot;,labels=c(&quot;Sertralex&quot;,&quot;Duloxyn&quot;),values=c(&quot;#FFDB6D&quot;,&quot;#00AFBB&quot;))+ xlab(&quot;Propensity Score (PS)&quot;)+ ylab(&quot;Density&quot;)+ xlim(0,1)+ labs(caption=&quot;&quot;)+ theme_minimal() #After weighting plot2&lt;-ggplot2::ggplot(data, mapping = aes(x = ps, weight = weights))+ ggplot2::geom_density(colour=&quot;red&quot;)+ ggplot2::geom_density(mapping=aes(group = TREAT, fill = TREAT),alpha=0.4)+ ggtitle(&quot;Weighted&quot;)+ scale_fill_manual(name=&quot;Treatment&quot;,labels=c(&quot;Sertralex&quot;,&quot;Duloxyn&quot;),values=c(&quot;#FFDB6D&quot;,&quot;#00AFBB&quot;))+ xlab(&quot;Propensity Score (PS)&quot;)+ ylab(&quot;Density&quot;)+ xlim(0,1)+ labs(caption=&quot;*the red line indicates the PS distribution for the overall population&quot;)+ theme_minimal() ggarrange(plot1,plot2,common.legend = T) We observed that after weighting the two distributions curves align, indicating the dataset is balanced on average. 4.5 Outcome analysis This section details the outcome analyis. First, unadjusted and weighted Kaplan-Meier curves (Cole and Hernán 2004), stratified on treatment group, are compared. #Implement unadjusted model unadjusted&lt;- survfit(Surv(TIME_TO_EVENT, EVENT)~TREAT, data = data) #Implement IPTW adjusted model weighted&lt;- survfit(Surv(TIME_TO_EVENT, EVENT)~TREAT, data = data, weights = weights) #Combine both fit&lt;-list(unadjusted,weighted) # Function to format survival probabilities at a given time point format_median_time &lt;- function(surv_object, treatment_index) { # Extract the median survival time for the given treatment index median_surv &lt;- sprintf(&quot;%.2f&quot;, round(summary(surv_object)$table[treatment_index, &quot;median&quot;], 2)) lower_ci &lt;- sprintf(&quot;%.2f&quot;, round(summary(surv_object)$table[treatment_index, &quot;0.95LCL&quot;], 2)) upper_ci &lt;- sprintf(&quot;%.2f&quot;, round(summary(surv_object)$table[treatment_index, &quot;0.95UCL&quot;], 2)) return(paste0(median_surv, &quot; [&quot;, lower_ci, &quot;; &quot;, upper_ci, &quot;]&quot;)) } # Usage for raw and IPTW median time unadjusted_treatment_0 &lt;- format_median_time(unadjusted, 1) unadjusted_treatment_1 &lt;- format_median_time(unadjusted, 2) weighted_treatment_0 &lt;- format_median_time(weighted, 1) weighted_treatment_1 &lt;- format_median_time(weighted, 2) ggsurvplot_combine(fit, data = data, legend.title = &quot;&quot;, legend.labs = c(&quot;Unadjusted: Sertralex&quot;, &quot;Unadjusted: Duloxyn&quot;, &quot;Weighted: Sertralex&quot;, &quot;Weighted: Duloxyn&quot;), palette = c(&quot;#ff331a&quot;,&quot;#ff80a6&quot;,&quot;#FFDB6D&quot;,&quot;#27d4ad&quot;), conf.int = TRUE, xlab = &quot;Time (in days)&quot;, ggtheme = theme_bw()) As outlined, the median time to relapse differs depending on the analysis and treatment group considered. In the unadjusted analysis, we observed a median survival time of 67.00 [58.00; 84.00] days for Sertralex, compared to 56.00 [47.00; 74.00] days for Duloxyn. In the weighted analysis (where weights are used to create a pseudo population), these differences were reduced, median survival time of 58.00 [46.00; 69.00] days for Sertralex and 64.00 [54.00; 91.00] days for Duloxyn. Second, unadjusted, multivariable, and weighted Cox are displayed. # Fit the Cox models unadjusted &lt;- coxph(Surv(TIME_TO_EVENT, EVENT) ~ TREAT, data = data) multivariable &lt;- coxph(Surv(TIME_TO_EVENT, EVENT) ~ TREAT + AGE + GENDER + SOCIO_ECO + BECK, data = data) weighted &lt;- coxph(Surv(TIME_TO_EVENT, EVENT) ~ TREAT, weights = weights, data = data) # Create regression tables unadjusted_table &lt;- unadjusted %&gt;% tbl_regression(exponentiate = TRUE, label = list(TREAT ~ &quot;Treatment (unadjusted)&quot;)) multivariable_table &lt;- multivariable %&gt;% tbl_regression(exponentiate = TRUE, label = list(TREAT ~ &quot;Treatment (multivariable regression)&quot;))%&gt;% modify_table_body( ~ .x %&gt;% dplyr::filter(variable == &quot;TREAT&quot;) ) weighted_table &lt;- weighted %&gt;% tbl_regression(exponentiate = TRUE, label = list(TREAT ~ &quot;Treatment (weighted)&quot;))%&gt;% modify_table_body( ~ .x %&gt;% dplyr::filter(variable == &quot;TREAT&quot;) ) # Function to extract HR and CI for a specific variable extract_hr_ci &lt;- function(model) { conf &lt;- confint(model) hr &lt;- sprintf(&quot;%.2f&quot;, exp(model$coefficients)[1]) ci_lower &lt;- sprintf(&quot;%.2f&quot;, exp(conf)[1,1]) ci_upper &lt;- sprintf(&quot;%.2f&quot;, exp(conf)[1,2]) return(paste0(&quot;HR = &quot;, hr, &quot; [&quot;, ci_lower, &quot;; &quot;, ci_upper, &quot;]&quot;)) } # Extract and format HR and CI for TREAT unadjusted_hr_ci &lt;- extract_hr_ci(unadjusted) multivariable_hr_ci &lt;- extract_hr_ci(multivariable) weighted_hr_ci &lt;- extract_hr_ci(weighted) # Stack the regression tables tbl_stack(list(unadjusted_table, multivariable_table, weighted_table)) #pdyvogezgd table { font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } #pdyvogezgd thead, #pdyvogezgd tbody, #pdyvogezgd tfoot, #pdyvogezgd tr, #pdyvogezgd td, #pdyvogezgd th { border-style: none; } #pdyvogezgd p { margin: 0; padding: 0; } #pdyvogezgd .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #pdyvogezgd .gt_caption { padding-top: 4px; padding-bottom: 4px; } #pdyvogezgd .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #pdyvogezgd .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #pdyvogezgd .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pdyvogezgd .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pdyvogezgd .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pdyvogezgd .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #pdyvogezgd .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #pdyvogezgd .gt_column_spanner_outer:first-child { padding-left: 0; } #pdyvogezgd .gt_column_spanner_outer:last-child { padding-right: 0; } #pdyvogezgd .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #pdyvogezgd .gt_spanner_row { border-bottom-style: hidden; } #pdyvogezgd .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #pdyvogezgd .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #pdyvogezgd .gt_from_md > :first-child { margin-top: 0; } #pdyvogezgd .gt_from_md > :last-child { margin-bottom: 0; } #pdyvogezgd .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #pdyvogezgd .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #pdyvogezgd .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #pdyvogezgd .gt_row_group_first td { border-top-width: 2px; } #pdyvogezgd .gt_row_group_first th { border-top-width: 2px; } #pdyvogezgd .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pdyvogezgd .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #pdyvogezgd .gt_first_summary_row.thick { border-top-width: 2px; } #pdyvogezgd .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pdyvogezgd .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pdyvogezgd .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #pdyvogezgd .gt_last_grand_summary_row_top { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; } #pdyvogezgd .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #pdyvogezgd .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pdyvogezgd .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pdyvogezgd .gt_footnote { margin: 0px; font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #pdyvogezgd .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pdyvogezgd .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #pdyvogezgd .gt_left { text-align: left; } #pdyvogezgd .gt_center { text-align: center; } #pdyvogezgd .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #pdyvogezgd .gt_font_normal { font-weight: normal; } #pdyvogezgd .gt_font_bold { font-weight: bold; } #pdyvogezgd .gt_font_italic { font-style: italic; } #pdyvogezgd .gt_super { font-size: 65%; } #pdyvogezgd .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; } #pdyvogezgd .gt_asterisk { font-size: 100%; vertical-align: 0; } #pdyvogezgd .gt_indent_1 { text-indent: 5px; } #pdyvogezgd .gt_indent_2 { text-indent: 10px; } #pdyvogezgd .gt_indent_3 { text-indent: 15px; } #pdyvogezgd .gt_indent_4 { text-indent: 20px; } #pdyvogezgd .gt_indent_5 { text-indent: 25px; } #pdyvogezgd .katex-display { display: inline-flex !important; margin-bottom: 0.75em !important; } #pdyvogezgd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after { height: 0px !important; } Characteristic HR1 95% CI1 p-value Treatment (unadjusted)     Sertralex — —     Duloxyn 1.11 0.92, 1.34 0.3 Treatment (multivariable regression)     Sertralex — —     Duloxyn 0.55 0.45, 0.68 Treatment (weighted)     Sertralex — —     Duloxyn 0.84 0.69, 1.03 0.095 1 HR = Hazard Ratio, CI = Confidence Interval The results indicate that the treatment effect varies depending on the analysis and treatment group considered. In the unadjusted analysis, the hazard ratio (HR = 1.11 [0.92; 1.34]) suggests that Duloxyn significantly increases the risk of relapse. In contrast, the multivariable model reveals the opposite findings with a hazard ratio of HR = 0.55 [0.45; 0.68]. Meanwhile, the IPTW analysis yielded non-significant results with HR = 0.84 [0.69; 1.03]. Finally, the slight differences between the multivariable and IPTW models demonstrate that conditional and marginal effects are not strictly equivalent. "],["clone-censor-weight.html", "Chapter 5 Clone-Censor-Weight method 5.1 Background 5.2 CCW implementation 5.3 Outcome analysis", " Chapter 5 Clone-Censor-Weight method 5.1 Background Another challenge common in RWD studies, in addition to confounding, is immortal time bias. This bias often occurs when there is a time difference between the beginning of follow-up (time zero) and the initiation of treatment, this is especially true when this systematically differs across groups. For instance, if Sertralex patients begin treatment later than Duloxyn individuals, a form of immortal time occurs. In other words, individuals on Duloxyn might experience an event sooner, simply due to the earlier start of their follow-up period. This difference in initiation timing may not be random and could, in fact, be influenced by various factors that need to be considered into the analysis. To address both confounding and immortal time bias, the Clone-Censor-Weight (CCW) approach was introduced (Hernán et al. 2016; Maringe et al. 2020). Three common scenarios were distinguished for the use of CCW: grace periods-a period during which treatment initiation can happen, static time-related strategies, and dynamic strategies (Zhao, Lyu, and Yoshida 2021). The scenario 2 discussed in Chapter 2 corresponds to the grace period scenario and will be applied to illustrate the application of CCW . 5.2 CCW implementation This code implements the CCW approach. 5.2.1 Cloning The cloning approach involves creating a duplicate of the initial dataset, where each clone is assigned the opposite treatment. # Step 1 cloning # Make a copy of original data original_data &lt;- data original_data &lt;- original_data %&gt;% mutate(SOCIO_ECO_2 = ifelse(SOCIO_ECO == &quot;Low&quot;, 1, 0), SOCIO_ECO_3 = ifelse(SOCIO_ECO == &quot;Moderate&quot;, 1, 0), SOCIO_ECO_4 = ifelse(SOCIO_ECO == &quot;High&quot;, 1, 0), SOCIO_ECO_5 = ifelse(SOCIO_ECO == &quot;Very high&quot;, 1, 0)) %&gt;% select(-SOCIO_ECO) # Create cloned data cloned_data &lt;- original_data %&gt;% mutate( ID = ID + 1000, # Modify ID to differentiate cloned records TREAT = ifelse(TREAT == &quot;Duloxyn&quot;, &quot;Sertralex&quot;, &quot;Duloxyn&quot;) ) # Remove TIME_TO_TREAT for clones 5.2.2 Censoring Next, the censoring pattern must be established in the dataset. In the original dataset, no censoring is applied, whereas in the cloned dataset, censoring is set at the time of treatment initiation. The two datasets are then merged and reformatted to include risk intervals for each individual, defined with start and stop times. # Step 2 censoring original_data &lt;- original_data %&gt;% mutate( CENSOR = 0, # Indicator for uncensored data in the original dataset TIME_TO_CENSOR = TIME_TO_TREAT # Initial censoring time is set to treatment time ) %&gt;% select(-TIME_TO_TREAT) # Remove TIME_TO_TREAT for simplicity cloned_data &lt;- cloned_data %&gt;% mutate( EVENT = 0, # No relapse events for cloned records CENSOR = 1, # Cloned records are censored TIME_TO_CENSOR = TIME_TO_TREAT # Use TIME_TO_EVENT as censoring time for clones ) %&gt;% select(-TIME_TO_TREAT) # Remove TIME_TO_TREAT for clones # Combine original and cloned datasets combined_data &lt;- bind_rows(original_data, cloned_data) %&gt;% mutate( TIME_TO_EVENT = TIME_TO_EVENT + 0.001, # Add small increments to avoid duplicate times TIME_TO_CENSOR = TIME_TO_CENSOR + 0.001, # Add small increments for censoring times TSTART = 0 # Set start time for all records ) # Identify unique times for events and censoring t_events &lt;- sort(unique(combined_data$TIME_TO_EVENT)) # Unique event times t_censor &lt;- sort(unique(combined_data$TIME_TO_CENSOR)) # Unique censoring times # Reshape data for events using survSplit combined_data_events &lt;- survSplit( Surv(TSTART, TIME_TO_EVENT, EVENT) ~ ., data = combined_data, cut = t_events, id = &quot;id&quot; ) %&gt;% rename(TSTOP = TIME_TO_EVENT) %&gt;% select(ID, TREAT, TSTART, TSTOP, EVENT) # Keep relevant columns for events # Reshape data for censoring using survSplit combined_data_cens &lt;- survSplit( Surv(TSTART, TIME_TO_CENSOR, CENSOR) ~ ., data = combined_data, cut = t_censor, id = &quot;id&quot; ) %&gt;% rename(TSTOP = TIME_TO_CENSOR) %&gt;% select(ID, TREAT, TSTART, TSTOP, CENSOR) # Extract covariates for the analysis combined_data_covariate &lt;- combined_data %&gt;% select(ID, AGE, GENDER, SOCIO_ECO_2, SOCIO_ECO_3, SOCIO_ECO_4, SOCIO_ECO_5, BECK) # Combine event and censoring datasets combined_data &lt;- full_join( combined_data_events, combined_data_cens, by = c(&quot;ID&quot;, &quot;TREAT&quot;, &quot;TSTART&quot;, &quot;TSTOP&quot;) # Merge by ID, treatment, start, and stop times ) %&gt;% mutate( EVENT = ifelse(is.na(EVENT), 0, EVENT), # Replace missing EVENT values with 0 CENSOR = ifelse(is.na(CENSOR), 0, CENSOR) # Replace missing CENSOR values with 0 ) %&gt;% group_by(ID) %&gt;% mutate( censor_cumsum = cumsum(cumsum(CENSOR)), # Count cumulative censored events per ID event_cumsum = cumsum(cumsum(EVENT)) # Count cumulative relapse events per ID ) %&gt;% filter(censor_cumsum &lt;= 1 &amp; event_cumsum &lt;= 1) %&gt;% # Retain only one censor or event per ID select(-censor_cumsum, -event_cumsum) %&gt;% inner_join(combined_data_covariate, by = &quot;ID&quot;) combined_data$TREAT&lt;-factor(combined_data$TREAT,levels=c(&quot;Sertralex&quot;,&quot;Duloxyn&quot;)) # Print first individual (ID = 3) and its clone (ID = 1003) combined_data %&gt;% filter(ID %in% c(3,1003)) %&gt;% arrange(ID) %&gt;% kbl() %&gt;% kable_styling(font_size = 12) %&gt;% scroll_box(width = &quot;100%&quot;, height = &quot;200px&quot;) ID TREAT TSTART TSTOP EVENT CENSOR AGE GENDER SOCIO_ECO_2 SOCIO_ECO_3 SOCIO_ECO_4 SOCIO_ECO_5 BECK 3 Sertralex 0.000 4.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 4.001 5.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 5.001 6.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 6.001 7.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 7.001 8.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 8.001 9.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 9.001 10.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 10.001 11.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 11.001 12.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 12.001 13.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 13.001 14.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 14.001 15.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 15.001 16.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 16.001 17.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 17.001 18.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 18.001 19.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 19.001 20.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 20.001 21.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 21.001 22.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 22.001 23.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 23.001 24.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 24.001 25.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 25.001 26.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 26.001 27.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 27.001 28.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 28.001 29.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 29.001 30.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 30.001 31.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 31.001 32.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 32.001 33.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 33.001 34.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 34.001 35.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 35.001 36.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 36.001 37.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 37.001 38.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 38.001 39.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 39.001 40.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 40.001 41.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 41.001 42.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 42.001 43.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 43.001 44.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 44.001 45.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 45.001 46.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 46.001 47.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 47.001 48.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 48.001 49.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 49.001 50.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 50.001 51.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 51.001 52.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 52.001 53.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 53.001 54.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 54.001 56.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 56.001 57.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 57.001 58.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 58.001 59.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 59.001 60.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 60.001 61.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 61.001 62.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 62.001 63.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 63.001 64.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 64.001 65.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 65.001 66.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 66.001 67.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 67.001 68.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 68.001 69.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 69.001 70.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 70.001 71.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 71.001 72.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 72.001 73.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 73.001 74.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 74.001 75.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 75.001 77.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 77.001 78.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 78.001 79.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 79.001 80.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 80.001 82.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 82.001 83.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 83.001 84.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 84.001 85.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 85.001 86.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 86.001 87.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 87.001 88.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 88.001 89.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 89.001 90.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 90.001 91.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 91.001 92.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 92.001 93.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 93.001 94.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 94.001 95.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 95.001 97.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 97.001 98.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 98.001 99.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 99.001 100.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 100.001 101.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 101.001 102.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 102.001 103.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 103.001 104.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 104.001 105.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 105.001 107.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 107.001 109.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 109.001 110.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 110.001 111.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 111.001 112.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 112.001 114.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 114.001 116.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 116.001 118.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 118.001 119.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 119.001 120.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 120.001 123.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 123.001 127.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 127.001 129.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 129.001 134.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 134.001 135.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 135.001 137.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 137.001 138.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 138.001 139.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 139.001 140.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 140.001 141.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 141.001 142.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 142.001 143.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 143.001 148.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 148.001 150.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 150.001 154.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 154.001 157.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 157.001 160.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 160.001 161.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 161.001 163.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 163.001 166.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 166.001 167.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 167.001 171.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 171.001 172.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 172.001 176.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 176.001 178.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 178.001 179.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 179.001 181.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 181.001 183.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 183.001 187.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 187.001 188.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 188.001 190.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 190.001 193.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 193.001 198.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 198.001 200.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 200.001 203.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 203.001 204.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 204.001 217.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 217.001 218.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 218.001 223.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 223.001 229.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 229.001 235.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 235.001 238.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 238.001 242.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 242.001 243.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 243.001 246.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 246.001 249.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 249.001 252.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 252.001 259.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 259.001 260.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 260.001 261.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 261.001 271.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 271.001 276.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 276.001 279.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 279.001 285.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 285.001 290.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 290.001 291.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 291.001 298.001 0 0 34 Female 0 0 0 1 23 3 Sertralex 298.001 308.001 1 0 34 Female 0 0 0 1 23 1003 Duloxyn 0.000 4.001 0 0 34 Female 0 0 0 1 23 1003 Duloxyn 4.001 5.001 0 0 34 Female 0 0 0 1 23 1003 Duloxyn 5.001 6.001 0 0 34 Female 0 0 0 1 23 1003 Duloxyn 6.001 7.001 0 0 34 Female 0 0 0 1 23 1003 Duloxyn 7.001 8.001 0 0 34 Female 0 0 0 1 23 1003 Duloxyn 8.001 9.001 0 0 34 Female 0 0 0 1 23 1003 Duloxyn 9.001 10.001 0 1 34 Female 0 0 0 1 23 5.2.3 Weighting Finally, the probability of remaining uncensored is estimated separately using a Cox model. # Step 3 weighting #Filter data for the &quot;Duloxyn&quot; treatment group and estimate censoring probabilities combined_data_duloxyn &lt;- combined_data %&gt;% filter(TREAT == &quot;Duloxyn&quot;) # Fit a Cox proportional hazards model to estimate the hazard for censoring ms_cens_duloxyn &lt;- coxph(Surv(TSTART, TSTOP, CENSOR) ~ AGE + GENDER + SOCIO_ECO_2 + SOCIO_ECO_3 + SOCIO_ECO_4 + SOCIO_ECO_5 + BECK, ties = &quot;efron&quot;, data = combined_data_duloxyn) # Extract the baseline hazard from the Cox model baseline_hazard &lt;- basehaz(ms_cens_duloxyn, centered = FALSE) # Calculate the linear predictor (lp) for the &quot;Duloxyn&quot; group combined_data_duloxyn$lp &lt;- predict(ms_cens_duloxyn, newdata = combined_data_duloxyn, type = &quot;lp&quot;) # Merge the baseline hazard with the dataset based on time combined_data_duloxyn &lt;- merge(combined_data_duloxyn, baseline_hazard, by.x = &quot;TSTOP&quot;, by.y = &quot;time&quot;, all.x = TRUE) # Calculate the uncensored probability combined_data_duloxyn$p_uncens &lt;- exp(-combined_data_duloxyn$hazard * exp(combined_data_duloxyn$lp)) # Calculate the weights as the inverse of the uncensored probability combined_data_duloxyn$weights &lt;- 1 / combined_data_duloxyn$p_uncens # Repeat the same process for the &quot;Sertralex&quot; treatment group # Filter data for the &quot;Sertralex&quot; treatment group combined_data_sertralex &lt;- combined_data %&gt;% filter(TREAT == &quot;Sertralex&quot;) # Fit a Cox proportional hazards model for censoring in the &quot;Sertralex&quot; group ms_cens_sertralex &lt;- coxph(Surv(TSTART, TSTOP, CENSOR) ~ AGE + GENDER + SOCIO_ECO_2 + SOCIO_ECO_3 + SOCIO_ECO_4 + SOCIO_ECO_5 + BECK, ties = &quot;efron&quot;, data = combined_data_sertralex) # Use the baseline hazard from the &quot;Duloxyn&quot; model (assumed shared here) baseline_hazard &lt;- basehaz(ms_cens_duloxyn, centered = FALSE) # Calculate the linear predictor (lp) for the &quot;Sertralex&quot; group combined_data_sertralex$lp &lt;- predict(ms_cens_sertralex, newdata = combined_data_sertralex, type = &quot;lp&quot;) # Merge the baseline hazard with the dataset based on time combined_data_sertralex &lt;- merge(combined_data_sertralex, baseline_hazard, by.x = &quot;TSTOP&quot;, by.y = &quot;time&quot;, all.x = TRUE) # Calculate the uncensored probability combined_data_sertralex$p_uncens &lt;- exp(-combined_data_sertralex$hazard * exp(combined_data_sertralex$lp)) # Calculate the weights as the inverse of the uncensored probability combined_data_sertralex$weights &lt;- 1 / combined_data_sertralex$p_uncens # Combine the datasets for &quot;Duloxyn&quot; and &quot;Sertralex&quot; treatments with the calculated weights combined_data &lt;- rbind(combined_data_duloxyn, combined_data_sertralex) # Display the first individual (ID = 3) and its clone (ID = 1003) with improved visualization combined_data %&gt;% filter(ID %in% c(3, 1003)) %&gt;% arrange(ID) %&gt;% kbl() %&gt;% kable_styling(font_size = 12) %&gt;% scroll_box(width = &quot;100%&quot;, height = &quot;200px&quot;) TSTOP ID TREAT TSTART EVENT CENSOR AGE GENDER SOCIO_ECO_2 SOCIO_ECO_3 SOCIO_ECO_4 SOCIO_ECO_5 BECK lp hazard p_uncens weights 4.001 3 Sertralex 0.000 0 0 34 Female 0 0 0 1 23 -0.3269311 0.0353463 0.9748327 1.025817 5.001 3 Sertralex 4.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.0897951 0.9372978 1.066897 6.001 3 Sertralex 5.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.1618184 0.8898586 1.123774 7.001 3 Sertralex 6.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.2280559 0.8483527 1.178755 8.001 3 Sertralex 7.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.3461736 0.7790833 1.283560 9.001 3 Sertralex 8.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.4478113 0.7240233 1.381171 10.001 3 Sertralex 9.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.5468552 0.6741144 1.483428 11.001 3 Sertralex 10.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.6352811 0.6324701 1.581103 12.001 3 Sertralex 11.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.6745200 0.6148242 1.626481 13.001 3 Sertralex 12.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.6894336 0.6082474 1.644068 14.001 3 Sertralex 13.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7130222 0.5979883 1.672274 15.001 3 Sertralex 14.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7209293 0.5945882 1.681836 16.001 3 Sertralex 15.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 17.001 3 Sertralex 16.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 18.001 3 Sertralex 17.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 19.001 3 Sertralex 18.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 20.001 3 Sertralex 19.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 21.001 3 Sertralex 20.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 22.001 3 Sertralex 21.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 23.001 3 Sertralex 22.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 24.001 3 Sertralex 23.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 25.001 3 Sertralex 24.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 26.001 3 Sertralex 25.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 27.001 3 Sertralex 26.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 28.001 3 Sertralex 27.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 29.001 3 Sertralex 28.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 30.001 3 Sertralex 29.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 31.001 3 Sertralex 30.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 32.001 3 Sertralex 31.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 33.001 3 Sertralex 32.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 34.001 3 Sertralex 33.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 35.001 3 Sertralex 34.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 36.001 3 Sertralex 35.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 37.001 3 Sertralex 36.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 38.001 3 Sertralex 37.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 39.001 3 Sertralex 38.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 40.001 3 Sertralex 39.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 41.001 3 Sertralex 40.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 42.001 3 Sertralex 41.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 43.001 3 Sertralex 42.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 44.001 3 Sertralex 43.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 45.001 3 Sertralex 44.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 46.001 3 Sertralex 45.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 47.001 3 Sertralex 46.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 48.001 3 Sertralex 47.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 49.001 3 Sertralex 48.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 50.001 3 Sertralex 49.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 51.001 3 Sertralex 50.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 52.001 3 Sertralex 51.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 53.001 3 Sertralex 52.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 54.001 3 Sertralex 53.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 56.001 3 Sertralex 54.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 57.001 3 Sertralex 56.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 58.001 3 Sertralex 57.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 59.001 3 Sertralex 58.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 60.001 3 Sertralex 59.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 61.001 3 Sertralex 60.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 62.001 3 Sertralex 61.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 63.001 3 Sertralex 62.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 64.001 3 Sertralex 63.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 65.001 3 Sertralex 64.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 66.001 3 Sertralex 65.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 67.001 3 Sertralex 66.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 68.001 3 Sertralex 67.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 69.001 3 Sertralex 68.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 70.001 3 Sertralex 69.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 71.001 3 Sertralex 70.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 72.001 3 Sertralex 71.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 73.001 3 Sertralex 72.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 74.001 3 Sertralex 73.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 75.001 3 Sertralex 74.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 77.001 3 Sertralex 75.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 78.001 3 Sertralex 77.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 79.001 3 Sertralex 78.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 80.001 3 Sertralex 79.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 82.001 3 Sertralex 80.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 83.001 3 Sertralex 82.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 84.001 3 Sertralex 83.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 85.001 3 Sertralex 84.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 86.001 3 Sertralex 85.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 87.001 3 Sertralex 86.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 88.001 3 Sertralex 87.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 89.001 3 Sertralex 88.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 90.001 3 Sertralex 89.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 91.001 3 Sertralex 90.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 92.001 3 Sertralex 91.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 93.001 3 Sertralex 92.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 94.001 3 Sertralex 93.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 95.001 3 Sertralex 94.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 97.001 3 Sertralex 95.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 98.001 3 Sertralex 97.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 99.001 3 Sertralex 98.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 100.001 3 Sertralex 99.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 101.001 3 Sertralex 100.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 102.001 3 Sertralex 101.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 103.001 3 Sertralex 102.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 104.001 3 Sertralex 103.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 105.001 3 Sertralex 104.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 107.001 3 Sertralex 105.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 109.001 3 Sertralex 107.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 110.001 3 Sertralex 109.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 111.001 3 Sertralex 110.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 112.001 3 Sertralex 111.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 114.001 3 Sertralex 112.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 116.001 3 Sertralex 114.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 118.001 3 Sertralex 116.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 119.001 3 Sertralex 118.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 120.001 3 Sertralex 119.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 123.001 3 Sertralex 120.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 127.001 3 Sertralex 123.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 129.001 3 Sertralex 127.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 134.001 3 Sertralex 129.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 135.001 3 Sertralex 134.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 137.001 3 Sertralex 135.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 138.001 3 Sertralex 137.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 139.001 3 Sertralex 138.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 140.001 3 Sertralex 139.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 141.001 3 Sertralex 140.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 142.001 3 Sertralex 141.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 143.001 3 Sertralex 142.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 148.001 3 Sertralex 143.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 150.001 3 Sertralex 148.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 154.001 3 Sertralex 150.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 157.001 3 Sertralex 154.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 160.001 3 Sertralex 157.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 161.001 3 Sertralex 160.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 163.001 3 Sertralex 161.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 166.001 3 Sertralex 163.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 167.001 3 Sertralex 166.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 171.001 3 Sertralex 167.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 172.001 3 Sertralex 171.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 176.001 3 Sertralex 172.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 178.001 3 Sertralex 176.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 179.001 3 Sertralex 178.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 181.001 3 Sertralex 179.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 183.001 3 Sertralex 181.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 187.001 3 Sertralex 183.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 188.001 3 Sertralex 187.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 190.001 3 Sertralex 188.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 193.001 3 Sertralex 190.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 198.001 3 Sertralex 193.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 200.001 3 Sertralex 198.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 203.001 3 Sertralex 200.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 204.001 3 Sertralex 203.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 217.001 3 Sertralex 204.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 218.001 3 Sertralex 217.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 223.001 3 Sertralex 218.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 229.001 3 Sertralex 223.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 235.001 3 Sertralex 229.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 238.001 3 Sertralex 235.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 242.001 3 Sertralex 238.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 243.001 3 Sertralex 242.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 246.001 3 Sertralex 243.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 249.001 3 Sertralex 246.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 252.001 3 Sertralex 249.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 259.001 3 Sertralex 252.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 260.001 3 Sertralex 259.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 261.001 3 Sertralex 260.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 271.001 3 Sertralex 261.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 276.001 3 Sertralex 271.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 279.001 3 Sertralex 276.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 285.001 3 Sertralex 279.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 290.001 3 Sertralex 285.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 291.001 3 Sertralex 290.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 298.001 3 Sertralex 291.001 0 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 308.001 3 Sertralex 298.001 1 0 34 Female 0 0 0 1 23 -0.3269311 0.7248048 0.5929288 1.686543 4.001 1003 Duloxyn 0.000 0 0 34 Female 0 0 0 1 23 0.2421007 0.0360903 0.9550646 1.047050 5.001 1003 Duloxyn 4.001 0 0 34 Female 0 0 0 1 23 0.2421007 0.0921679 0.8892163 1.124586 6.001 1003 Duloxyn 5.001 0 0 34 Female 0 0 0 1 23 0.2421007 0.1644918 0.8109493 1.233123 7.001 1003 Duloxyn 6.001 0 0 34 Female 0 0 0 1 23 0.2421007 0.2329759 0.7431977 1.345537 8.001 1003 Duloxyn 7.001 0 0 34 Female 0 0 0 1 23 0.2421007 0.3543962 0.6366895 1.570624 9.001 1003 Duloxyn 8.001 0 0 34 Female 0 0 0 1 23 0.2421007 0.4598797 0.5566319 1.796519 10.001 1003 Duloxyn 9.001 0 1 34 Female 0 0 0 1 23 0.2421007 0.5589815 0.4906133 2.038265 5.3 Outcome analysis First, the KM model is implemented. #Implement CCW model ccw&lt;- survfit(Surv(TSTART, TSTOP, EVENT) ~ TREAT, data = combined_data, weights = weights) # Calculate median survival time ccw_treatment_0 &lt;- format_median_time(ccw, 1) ccw_treatment_1 &lt;- format_median_time(ccw, 2) ggsurvplot(ccw, data = combined_data, legend.title = &quot;&quot;, legend.labs = c(&quot;CCW: Sertralex&quot;, &quot;CCW: Duloxyn&quot;), palette = c(&quot;#5A8DEE&quot;,&quot;#F28C2C&quot;), conf.int = TRUE, xlab = &quot;Time (in days)&quot;, ggtheme = theme_bw()) In the CCW approach, the estimated median survival time in the Sertralex population is estimated at 51.00 [40.00; 62.00] and 68.00 [56.00; 93.00] in the Duloxyn population. Next, the Cox model is implemented where weights are considered into the analysis. # Fit the Cox models combined_data$TREAT &lt;- relevel(combined_data$TREAT,ref=&quot;Sertralex&quot;) CCW_cox &lt;- coxph(Surv(TSTART, TSTOP, EVENT) ~ TREAT, data = combined_data, weights = weights) # Create regression tables CCW_cox %&gt;% tbl_regression(exponentiate = TRUE, label = list(TREAT ~ &quot;Treatment (CCW approach)&quot;)) #zqlhpomdyp table { font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } #zqlhpomdyp thead, #zqlhpomdyp tbody, #zqlhpomdyp tfoot, #zqlhpomdyp tr, #zqlhpomdyp td, #zqlhpomdyp th { border-style: none; } #zqlhpomdyp p { margin: 0; padding: 0; } #zqlhpomdyp .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #zqlhpomdyp .gt_caption { padding-top: 4px; padding-bottom: 4px; } #zqlhpomdyp .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #zqlhpomdyp .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #zqlhpomdyp .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zqlhpomdyp .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zqlhpomdyp .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zqlhpomdyp .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #zqlhpomdyp .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #zqlhpomdyp .gt_column_spanner_outer:first-child { padding-left: 0; } #zqlhpomdyp .gt_column_spanner_outer:last-child { padding-right: 0; } #zqlhpomdyp .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #zqlhpomdyp .gt_spanner_row { border-bottom-style: hidden; } #zqlhpomdyp .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #zqlhpomdyp .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #zqlhpomdyp .gt_from_md > :first-child { margin-top: 0; } #zqlhpomdyp .gt_from_md > :last-child { margin-bottom: 0; } #zqlhpomdyp .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #zqlhpomdyp .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #zqlhpomdyp .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #zqlhpomdyp .gt_row_group_first td { border-top-width: 2px; } #zqlhpomdyp .gt_row_group_first th { border-top-width: 2px; } #zqlhpomdyp .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zqlhpomdyp .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #zqlhpomdyp .gt_first_summary_row.thick { border-top-width: 2px; } #zqlhpomdyp .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zqlhpomdyp .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zqlhpomdyp .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #zqlhpomdyp .gt_last_grand_summary_row_top { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; } #zqlhpomdyp .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #zqlhpomdyp .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zqlhpomdyp .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zqlhpomdyp .gt_footnote { margin: 0px; font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #zqlhpomdyp .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zqlhpomdyp .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #zqlhpomdyp .gt_left { text-align: left; } #zqlhpomdyp .gt_center { text-align: center; } #zqlhpomdyp .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #zqlhpomdyp .gt_font_normal { font-weight: normal; } #zqlhpomdyp .gt_font_bold { font-weight: bold; } #zqlhpomdyp .gt_font_italic { font-style: italic; } #zqlhpomdyp .gt_super { font-size: 65%; } #zqlhpomdyp .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; } #zqlhpomdyp .gt_asterisk { font-size: 100%; vertical-align: 0; } #zqlhpomdyp .gt_indent_1 { text-indent: 5px; } #zqlhpomdyp .gt_indent_2 { text-indent: 10px; } #zqlhpomdyp .gt_indent_3 { text-indent: 15px; } #zqlhpomdyp .gt_indent_4 { text-indent: 20px; } #zqlhpomdyp .gt_indent_5 { text-indent: 25px; } #zqlhpomdyp .katex-display { display: inline-flex !important; margin-bottom: 0.75em !important; } #zqlhpomdyp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after { height: 0px !important; } Characteristic HR1 95% CI1 p-value Treatment (CCW approach)     Sertralex — —     Duloxyn 0.71 0.58, 0.88 0.002 1 HR = Hazard Ratio, CI = Confidence Interval ccw_hr_ci &lt;- extract_hr_ci(CCW_cox) After adjusting for immortal time bias, the estimated treatment effect is represented by HR = 0.71 [0.58; 0.88], indicating that the association becomes significant. This finding aligns with the simulation process, which modeled a average difference in treatment initiation of 5 days (15 days for Duloxyn and 10 days for Sertralex), thereby offering a survival advantage for Duloxyn users. "],["conclusion.html", "Conclusion", " Conclusion As highlighted, careful consideration is essential when using RWD to generate RWE that complements the findings of RCTs. However, following guidance on its application and the use of appropriate statistical methods are crucial to ensuring the reliability and robustness of its conclusions. "],["references.html", "References", " References Austin, Peter C. 2009. “Balance Diagnostics for Comparing the Distribution of Baseline Covariates Between Treatment Groups in Propensity-Score Matched Samples.” Statistics in Medicine 28 (25): 3083. https://doi.org/10.1002/sim.3697. ———. 2011. “An Introduction to Propensity Score Methods for Reducing the Effects of Confounding in Observational Studies.” Multivariate Behavioral Research 46 (3): 399. https://doi.org/10.1080/00273171.2011.568786. Austin, Peter C., Paul Grootendorst, Sharon-Lise T. Normand, and Geoffrey M. Anderson. 2007. “Conditioning on the Propensity Score Can Result in Biased Estimation of Common Measures of Treatment Effect: A Monte Carlo Study.” Statistics in Medicine 26 (4): 754–68. https://doi.org/10.1002/sim.2618. Austin, Peter C., and Elizabeth A. Stuart. 2015. “Moving Towards Best Practice When Using Inverse Probability of Treatment Weighting (IPTW) Using the Propensity Score to Estimate Causal Treatment Effects in Observational Studies.” Statistics in Medicine 34 (28): 3661–79. https://doi.org/10.1002/sim.6607. Baumfeld Andre, Elodie, Robert Reynolds, Patrick Caubel, Laurent Azoulay, and Nancy A. Dreyer. 2020. “Trial Designs Using Real‐world Data: The Changing Landscape of the Regulatory Approval Process.” Pharmacoepidemiology and Drug Safety 29 (10): 1201–12. https://doi.org/10.1002/pds.4932. Cole, Stephen R., and Miguel A. Hernán. 2004. “Adjusted Survival Curves with Inverse Probability Weights.” Computer Methods and Programs in Biomedicine 75 (1): 45–49. https://doi.org/10.1016/j.cmpb.2003.10.004. EMA. 2023. “Real-World Evidence Framework to Support EU Regulatory Decision-Making.” European Medicines Agency (EMA). 2023. https://www.ema.europa.eu/en/documents/report/real-world-evidence-framework-support-eu-regulatory-decision-making-report-experience-gained-regulator-led-studies-september-2021-february-2023_en.pdf. FDA. 2018. “Real-World Evidence. FDA.” 2018. https://www.fda.gov/science-research/science-and-research-special-topics/real-world-evidence. ———. 2023. “Considerations for the Use of Real-World Data and Real-World Evidence to Support Regulatory Decision-Making for Drug and Biological Products.” Guidance Document. https://www.fda.gov/media/154714/download. Franklin, Jessica M., Elisabetta Patorno, Rishi J. Desai, Robert J. Glynn, David Martin, Kenneth Quinto, Ajinkya Pawar, et al. 2021. “Emulating Randomized Clinical Trials with Nonrandomized Real-World Evidence Studies: First Results from the RCT DUPLICATE Initiative.” Circulation 143 (10): 1002–13. https://doi.org/10.1161/CIRCULATIONAHA.120.051718. Funk, Michele Jonsson, Daniel Westreich, Chris Wiesen, Til Stürmer, M. Alan Brookhart, and Marie Davidian. 2011. “Doubly Robust Estimation of Causal Effects.” American Journal of Epidemiology 173 (7): 761. https://doi.org/10.1093/aje/kwq439. Garrido, Melissa M., Amy S. Kelley, Julia Paris, Katherine Roza, Diane E. Meier, R. Sean Morrison, and Melissa D. Aldridge. 2014. “Methods for Constructing and Assessing Propensity Scores.” Health Services Research 49 (5): 1701. https://doi.org/10.1111/1475-6773.12182. Greifer, Noah, and Elizabeth A. Stuart. 2023. “Choosing the Causal Estimand for Propensity Score Analysis of Observational Studies.” arXiv. https://doi.org/10.48550/arXiv.2106.10577. Heiss, Andrew. n.d. “Demystifying Causal Inference Estimands: ATE, ATT, and ATU. Andrew Heiss.” Accessed November 4, 2024. https://www.andrewheiss.com/blog/2024/03/21/demystifying-ate-att-atu/. Hernan, Miguel A, and James M Robins. 2024. “Causal Inference: What If,” January. Hernán, Miguel A., and James M. Robins. 2016. “Using Big Data to Emulate a Target Trial When a Randomized Trial Is Not Available.” American Journal of Epidemiology 183 (8): 758–64. https://doi.org/10.1093/aje/kwv254. Hernán, Miguel A., Brian C. Sauer, Sonia Hernández-Díaz, Robert Platt, and Ian Shrier. 2016. “Specifying a Target Trial Prevents Immortal Time Bias and Other Self-Inflicted Injuries in Observational Analyses.” Journal of Clinical Epidemiology 79 (November): 70–75. https://doi.org/10.1016/j.jclinepi.2016.04.014. “ICH E9 R1 Addendum.” 2020. July 30, 2020. https://www.ema.europa.eu/en/ich-e9-statistical-principles-clinical-trials-scientific-guideline. Khosla, Sajan, Robert White, Jesús Medina, Mario Ouwens, Cathy Emmas, Tim Koder, Gary Male, and Sandra Leonard. 2018. “Real World Evidence (RWE) – a Disruptive Innovation or the Quiet Evolution of Medical Evidence Generation?” F1000Research 7 (August): 111. https://doi.org/10.12688/f1000research.13585.2. Lawrance, Rachael, Evgeny Degtyarev, Philip Griffiths, Peter Trask, Helen Lau, Denise D’Alessio, Ingolf Griebsch, Gudrun Wallenstein, Kim Cocks, and Kaspar Rufibach. 2020. “What Is an Estimand &amp; How Does It Relate to Quantifying the Effect of Treatment on Patient-Reported Quality of Life Outcomes in Clinical Trials?” Journal of Patient-Reported Outcomes 4 (1): 68. https://doi.org/10.1186/s41687-020-00218-5. MacKinnon, David P., and Sophia J. Lamp. 2021. “A Unification of Mediator, Confounder, and Collider Effects.” Prevention Science : The Official Journal of the Society for Prevention Research 22 (8): 1185. https://doi.org/10.1007/s11121-021-01268-x. Maringe, Camille, Sara Benitez Majano, Aimilia Exarchakou, Matthew Smith, Bernard Rachet, Aurélien Belot, and Clémence Leyrat. 2020. “Reflection on Modern Methods: Trial Emulation in the Presence of Immortal-Time Bias. Assessing the Benefit of Major Surgery for Elderly Lung Cancer Patients Using Observational Data.” International Journal of Epidemiology 49 (5): 1719. https://doi.org/10.1093/ije/dyaa057. Normand, S. T., M. B. Landrum, E. Guadagnoli, J. Z. Ayanian, T. J. Ryan, P. D. Cleary, and B. J. McNeil. 2001. “Validating Recommendations for Coronary Angiography Following Acute Myocardial Infarction in the Elderly: A Matched Analysis Using Propensity Scores.” Journal of Clinical Epidemiology 54 (4): 387–98. https://doi.org/10.1016/s0895-4356(00)00321-8. Robins, J. M., and D. M. Finkelstein. 2000. “Correcting for Noncompliance and Dependent Censoring in an AIDS Clinical Trial with Inverse Probability of Censoring Weighted (IPCW) Log-Rank Tests.” Biometrics 56 (3): 779–88. https://doi.org/10.1111/j.0006-341x.2000.00779.x. Roca, L., and S. Gourgou. 2024. “P07- Mise à Jour Règlementaire : Intérêt Et Mise En Œuvre de l’estimand Dans Les Essais Cliniques En Oncologie.” Journal of Epidemiology and Population Health, EPICLIN 2024, 18ème conférence francophone d’épidémiologie clinique, 31èmes journées des statisticiens des centres de lutte contre le cancer, dijon, 15-17 mai 2024, 72 (May): 202447. https://doi.org/10.1016/j.jeph.2024.202447. Tennant, Peter W G, Eleanor J Murray, Kellyn F Arnold, Laurie Berrie, Matthew P Fox, Sarah C Gadd, Wendy J Harrison, et al. 2021. “Use of Directed Acyclic Graphs (DAGs) to Identify Confounders in Applied Health Research: Review and Recommendations.” International Journal of Epidemiology 50 (2): 620–32. https://doi.org/10.1093/ije/dyaa213. Zhao, Sizheng Steven, Houchen Lyu, and Kazuki Yoshida. 2021. “Versatility of the Clone-Censor-Weight Approach: Response to ‘Trial Emulation in the Presence of Immortal-Time Bias’.” International Journal of Epidemiology 50 (2): 694–95. https://doi.org/10.1093/ije/dyaa223. "],["r-packages.html", "Appendix A Installed packages", " Appendix A Installed packages This is the R packages installed and loaded to write this book, with the use of the pacman library. #Install pacman library if (!require(&quot;pacman&quot;)) install.packages(&quot;pacman&quot;, repos = &quot;https://cloud.r-project.org&quot;) # Load pacman library(pacman) # Install and load the packages pacman::p_load( cobalt, WeightIt, gtsummary, smd, survey, ggplot2, dplyr, ggpubr, cardx, broom, broom.helpers, survminer, survival, dagitty, ggdag, kable, kableExtra ) "],["r-code.html", "Appendix B R code of the simulated dataset", " Appendix B R code of the simulated dataset This is the R code to reproduce the motivating example: # Ensure reproducibility set.seed(42) # Number of patients N &lt;- 800 # Patient IDs ID &lt;- 1:N # Generation of base variables AGE &lt;- pmax(pmin(round(rnorm(N, mean = 32, sd = 6.19)), 80), 18) # Age bounded between 18 and 80 GENDER &lt;- sample(0:1, N, replace = TRUE) # Binary gender variable SOCIO_ECO &lt;- sample(1:5, N, replace = TRUE) # Socioeconomic status categories SOCIO_ECO_2 &lt;- as.numeric(SOCIO_ECO == 2) # Dummy variable for SOCIO_ECO == 2 SOCIO_ECO_3 &lt;- as.numeric(SOCIO_ECO == 3) # Dummy variable for SOCIO_ECO == 3 SOCIO_ECO_4 &lt;- as.numeric(SOCIO_ECO == 4) # Dummy variable for SOCIO_ECO == 4 SOCIO_ECO_5 &lt;- as.numeric(SOCIO_ECO == 5) # Dummy variable for SOCIO_ECO == 5 BECK &lt;- pmax(pmin(round(rnorm(N, mean = 30, sd = 9.33)), 63), 0) # Beck score bounded between 0 and 63 # Utility function to generate binary variables based on a logistic model logit_prob &lt;- function(eta) { 1 / (1 + exp(-eta)) # Logistic function } # Coefficients for predictors coefficients &lt;- list( intercept = -1.5, # Base intercept for treatment assignment age = -0.04, # Negative effect of age gender = -0.3, # Negative effect of gender (e.g., Female is less likely to be assigned) beck = 0.1, # Positive effect of Beck score socio_eco_2 = -0.10, # Negative effect for SOCIO_ECO_2 socio_eco_3 = -0.12, # Negative effect for SOCIO_ECO_3 socio_eco_4 = -0.18, # Negative effect for SOCIO_ECO_4 socio_eco_5 = -0.25 # Stronger negative effect for SOCIO_ECO_5 ) # Generation of initial treatment (TREAT) eta_treat &lt;- coefficients$intercept + coefficients$age * AGE + coefficients$gender * GENDER + coefficients$beck * BECK + coefficients$socio_eco_2 * SOCIO_ECO_2 + coefficients$socio_eco_3 * SOCIO_ECO_3 + coefficients$socio_eco_4 * SOCIO_ECO_4 + coefficients$socio_eco_5 * SOCIO_ECO_5 TREAT &lt;- rbinom(N, 1, logit_prob(eta_treat + rnorm(N))) # Simulating treatment assignment # Coefficients for treatment delay based on treatment status coefficients_delay &lt;- list( sertralex = list( intercept = 10, # Base parameter for delay age = -0.02, # Negative effect of age on delay gender = 0.1, # Positive effect of gender on delay beck = -0.05, # Negative effect of Beck score on delay socio_eco_2 = 0.2, socio_eco_3 = 0.15, socio_eco_4 = 0.1, socio_eco_5 = 0.05 ), duloxyn = list( intercept = 15, age = -0.02, gender = 0.1, beck = -0.05, socio_eco_2 = 0.2, socio_eco_3 = 0.15, socio_eco_4 = 0.1, socio_eco_5 = 0.05 ) ) # Initialization of TIME_TO_TREAT variable TIME_TO_TREAT &lt;- numeric(N) # Generation of treatment initiation delays for (i in 1:N) { # Select appropriate coefficients delay_coeffs &lt;- if (TREAT[i] == 1) { coefficients_delay$duloxyn } else { coefficients_delay$sertralex } # Compute the mean linear_pred &lt;- delay_coeffs$intercept + delay_coeffs$age * AGE[i] + delay_coeffs$gender * GENDER[i] + delay_coeffs$beck * BECK[i] + delay_coeffs$socio_eco_2 * SOCIO_ECO_2[i] + delay_coeffs$socio_eco_3 * SOCIO_ECO_3[i] + delay_coeffs$socio_eco_4 * SOCIO_ECO_4[i] + delay_coeffs$socio_eco_5 * SOCIO_ECO_5[i] # Generate time from a normal distribution TIME_TO_TREAT[i] &lt;- round(rnorm(n = 1, mean = linear_pred + rnorm(n = 1), sd = 2.5), 0) } # Generation of relapse (EVENT) and time until relapse (TIME_TO_EVENT) in days base_hazard &lt;- 0.005 # Baseline hazard rate EVENT &lt;- numeric(N) TIME_TO_EVENT &lt;- numeric(N) max_follow_up &lt;- 365 # Maximum follow-up duration in days coefficients &lt;- list( intercept = -4, # Base intercept for event hazard age = -0.01, # Younger individuals are more likely to experience PDD gender = 0.1, # Women are more likely to experience PDD socio_eco_2 = -0.05, # Lower SES is more likely to experience PDD socio_eco_3 = -0.10, socio_eco_4 = -0.15, socio_eco_5 = -0.20, beck = 0.2, # Higher Beck score increases the likelihood of PDD treat = -0.2 # Protective effect of Duloxyn ) for (i in 1:N) { eta_event &lt;- coefficients$intercept + coefficients$age * AGE[i] + coefficients$gender * GENDER[i] + coefficients$beck * BECK[i] + coefficients$socio_eco_2 * SOCIO_ECO_2[i] + coefficients$socio_eco_3 * SOCIO_ECO_3[i] + coefficients$socio_eco_4 * SOCIO_ECO_4[i] + coefficients$socio_eco_5 * SOCIO_ECO_5[i] + coefficients$treat * TREAT[i] adjusted_hazard &lt;- base_hazard * exp(eta_event) # Adjust hazard rate # Generate time to event in days TIME_TO_EVENT[i] &lt;- round(rexp(1, rate = adjusted_hazard), 0) # Ensure EVENT only occurs within 365 days if (TIME_TO_EVENT[i] &lt; max_follow_up) { EVENT[i] &lt;- 1 } else { EVENT[i] &lt;- 0 } # Ensure TIME_TO_EVENT doesn&#39;t exceed the maximum follow-up period TIME_TO_EVENT[i] &lt;- min(TIME_TO_EVENT[i], max_follow_up) } # Organize data in a data frame data &lt;- data.frame(ID, AGE, GENDER, SOCIO_ECO, BECK, TREAT, TIME_TO_EVENT, EVENT, TIME_TO_TREAT) # Filter data based on conditions data &lt;- data %&gt;% filter(TIME_TO_EVENT &gt; TIME_TO_TREAT &amp; TIME_TO_TREAT &lt; 30 &amp; TIME_TO_EVENT &gt; 0) # Recategorize variables data$GENDER &lt;- factor(data$GENDER, levels = c(0, 1), labels = c(&quot;Male&quot;, &quot;Female&quot;)) data$SOCIO_ECO &lt;- factor(data$SOCIO_ECO, levels = c(1, 2, 3, 4, 5), labels = c(&quot;Very low&quot;, &quot;Low&quot;, &quot;Moderate&quot;, &quot;High&quot;, &quot;Very high&quot;)) data$TREAT &lt;- factor(data$TREAT, levels = c(0, 1), labels = c(&quot;Sertralex&quot;, &quot;Duloxyn&quot;)) "],["ich.html", "Appendix C ICH E9 (R1) addendum", " Appendix C ICH E9 (R1) addendum In 2020, the International Council for Harmonisation of Technical Requirements for Pharmaceuticals for Human Use (ICH) released the E9 (R1) addendum, which aims to guide practice regarding estimands and sensitivity analyses in clinical trials, moving beyond traditional ITT and PP analyses (“ICH E9 R1 Addendum” 2020). An estimand provides a clear definition of the treatment effect that reflects the clinical question posed by a specific trial objective. Its formulation is based on five attributes: treatment, population, variable of interest (endpoint), intercurrent event handling, and summary measure. The concept of intercurrent events, introduced in this framework, refers to events occurring after treatment initiation. Five strategies exist for handling intercurrent events, including treatment policy, while on treatment, hypothetical, composite approaches, and principal stratum strategy (Lawrance et al. 2020; Roca and Gourgou 2024). In our example, we reformulate the ITT and PP questions as suggested in the framework: ITT: “In patients diagnosed with PDD, what is the effect of Duloxyn compared to Sertralex on the time to relapse from the date of diagnosis, over a one-year follow-up period or until death (whichever occurs first), regardless of study treatment discontinuation?” (this follows the treatment policy approach to handle treatment discontinuation). PP: “In patients diagnosed with PDD, what is the effect of Duloxyn compared to Sertralex on the time to relapse from the date of diagnosis, over a one-year follow-up period or until death, or treatment discontinuation (whichever occurs first)?” (this follows the principal stratum strategy to handle treatment discontinuation). "],["dag.html", "Appendix D DAG of the simulated dataset", " Appendix D DAG of the simulated dataset This is the DAG associated with the simulation process: For simplicity, Z represents the confounders measured at baseline, which include age, gender, socioeconomic status, and the Beck score. "],["causal.html", "Appendix E Causal inference estimand", " Appendix E Causal inference estimand A causal estimand is a description of the quantity that is to be estimated. In the context of RWD, methods such as matching or weighting imply the selection of an estimand. Among these, two estimands are typically of interest: the average treatment effect in the treated (ATT) and the average treatment effect in the population (ATE). The ATT is considered when assessing the effect of a treatment among individuals who are likely to receive it (e.g., when comparing a new drug to a placebo or standard of care). In our example, the research question would be framed as: what is the treatment effect among patients likely to receive Duloxyn? This includes individuals with characteristics similar to those receiving Sertralex, while individuals with characteristics unique to Duloxyn would be excluded from the analysis. This estimator typically involves pair matching statistical methods (Greifer and Stuart 2023; Heiss n.d.). "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
