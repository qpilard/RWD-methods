<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Propensity score methods | Methods for the analysis of Real World Data</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Propensity score methods | Methods for the analysis of Real World Data" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="http://qpilard.github.io/RWD-methods//images/logo.jpeg" />
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="qpilard/RWD-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Propensity score methods | Methods for the analysis of Real World Data" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="twitter:image" content="http://qpilard.github.io/RWD-methods//images/logo.jpeg" />

<meta name="author" content="Quentin Pilard" />


<meta name="date" content="2024-11-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="target-trial-emulation.html"/>
<link rel="next" href="clone-censor-weight.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<ul class="toc">
  <li class="toc-logo">
    <a href="./">
      <img src="images/logo.jpg" alt="Logo">
    </a>
  </li>
  <li class="toc-text">
    <a href="./">Real World Data methods</a>
  </li>
</ul>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#definition"><i class="fa fa-check"></i><b>1.1</b> Definition</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#use-of-rwd-in-drug-development"><i class="fa fa-check"></i><b>1.2</b> Use of RWD in drug development</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#addressing-challenges-with-rwd-external-control-arms-and-emulation-of-trials"><i class="fa fa-check"></i><b>1.3</b> Addressing Challenges with RWD: External Control Arms and Emulation of Trials</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivating-example.html"><a href="motivating-example.html"><i class="fa fa-check"></i><b>2</b> Motivating example</a></li>
<li class="chapter" data-level="3" data-path="target-trial-emulation.html"><a href="target-trial-emulation.html"><i class="fa fa-check"></i><b>3</b> Target Trial Emulation using observational data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="target-trial-emulation.html"><a href="target-trial-emulation.html#background"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="target-trial-emulation.html"><a href="target-trial-emulation.html#specify-the-target-trial"><i class="fa fa-check"></i><b>3.2</b> Specify the target trial</a></li>
<li class="chapter" data-level="3.3" data-path="target-trial-emulation.html"><a href="target-trial-emulation.html#emulate-the-target-trial"><i class="fa fa-check"></i><b>3.3</b> Emulate the target trial</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="iptw-application.html"><a href="iptw-application.html"><i class="fa fa-check"></i><b>4</b> Propensity score methods</a>
<ul>
<li class="chapter" data-level="4.1" data-path="iptw-application.html"><a href="iptw-application.html#background-1"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="iptw-application.html"><a href="iptw-application.html#identify-confounders"><i class="fa fa-check"></i><b>4.2</b> Identify confounders</a></li>
<li class="chapter" data-level="4.3" data-path="iptw-application.html"><a href="iptw-application.html#iptw-implementation"><i class="fa fa-check"></i><b>4.3</b> IPTW implementation</a></li>
<li class="chapter" data-level="4.4" data-path="iptw-application.html"><a href="iptw-application.html#balance-diagnostics"><i class="fa fa-check"></i><b>4.4</b> Balance Diagnostics</a></li>
<li class="chapter" data-level="4.5" data-path="iptw-application.html"><a href="iptw-application.html#outcome-analysis"><i class="fa fa-check"></i><b>4.5</b> Outcome analysis</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="clone-censor-weight.html"><a href="clone-censor-weight.html"><i class="fa fa-check"></i><b>5</b> Clone-Censor-Weight method</a>
<ul>
<li class="chapter" data-level="5.1" data-path="clone-censor-weight.html"><a href="clone-censor-weight.html#background-2"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="clone-censor-weight.html"><a href="clone-censor-weight.html#ccw-implementation"><i class="fa fa-check"></i><b>5.2</b> CCW implementation</a></li>
<li class="chapter" data-level="5.3" data-path="clone-censor-weight.html"><a href="clone-censor-weight.html#outcome-analysis-1"><i class="fa fa-check"></i><b>5.3</b> Outcome analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="r-code.html"><a href="r-code.html"><i class="fa fa-check"></i><b>A</b> R code of the simulated dataset</a></li>
<li class="chapter" data-level="B" data-path="ich.html"><a href="ich.html"><i class="fa fa-check"></i><b>B</b> ICH E9 (R1) addendum</a></li>
<li class="chapter" data-level="C" data-path="dag.html"><a href="dag.html"><i class="fa fa-check"></i><b>C</b> DAG of the simulated dataset</a></li>
<li class="chapter" data-level="D" data-path="causal.html"><a href="causal.html"><i class="fa fa-check"></i><b>D</b> Causal inference estimand</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Methods for the analysis of Real World Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="iptw-application" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Propensity score methods<a href="iptw-application.html#iptw-application" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="background-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Background<a href="iptw-application.html#background-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <strong>Propensity Score (PS)</strong> is utilized to emulate the randomization process, with the goal of balancing the population’s characteristics across the groups of interest. Unlike multivariable regression, which focuses on estimating the effect at the individual level (<em>subject-specific effect</em>), the PS method estimates the effect at the population level (<em>population-average effect</em>). In the context of models with a non-linear link (typically when Odds Ratio [OR] or Hazard Ratio [HR] are reported), these two effects differ <span class="citation">(<a href="references.html#ref-austin_conditioning_2007">Austin et al. 2007</a>)</span>.</p>
<p>Statistically, the PS is defined as the conditional probability of receiving the exposure of interest based on observed baseline characteristics. It is typically estimated using multivariable logistic regression, where the exposure of interest serves as the dependent variable and the baseline characteristics act as independent variables. Once calculated, it can be employed in various approaches, including matching, stratification, <strong>Inverse Probability of Treatment Weighting</strong> (IPTW), and covariate adjustment <span class="citation">(<a href="references.html#ref-austin_introduction_2011">Austin 2011</a>)</span>.</p>
<p>The scenario 1 discussed in Chapter <a href="motivating-example.html#motivating-example">2</a> will be applied to illustrate the application of IPTW.</p>
</div>
<div id="identify-confounders" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Identify confounders<a href="iptw-application.html#identify-confounders" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The baseline characteristics incorporated in the logistic regression must be defined as <strong>confounders - variables that influence both treatment assignment and the outcome without being part on the causal pathway</strong>. Other types of variables, such as <strong>mediators or colliders</strong>, may also be present; however, adjusting for these can introduce bias <span class="citation">(<a href="references.html#ref-mackinnon_unification_2021">MacKinnon and Lamp 2021</a>)</span>.</p>
<p><strong>Directed Acyclic Graphs</strong> (DAGs) are usually recommended to depict causal relationships, ideally, clinical experts should be involved in their development as they more likely to know involved clinical pathways, interacting with the disease of interest <span class="citation">(<a href="references.html#ref-hernan_causal_nodate">Hernan and Robins 2024</a>; <a href="references.html#ref-tennant_use_2021">Tennant et al. 2021</a>)</span>. DAGs can be created using the DAGitty <a href="https://www.dagitty.net/">website</a> or dagitty R <a href="https://github.com/jtextor/dagitty">package</a>.</p>
<p>In our example, we identified age at diagnosis, gender, Beck score and socioeconomic status as potential confounders of the association between treatment exposure and relapse. The associated DAG is represented in Appendix <a href="dag.html#dag">C</a>.</p>
</div>
<div id="iptw-implementation" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> IPTW implementation<a href="iptw-application.html#iptw-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This code implements the IPTW approach using the <strong>stabilized Average Treatment Effect (ATE)</strong> estimand <span class="citation">(<a href="references.html#ref-austin_moving_2015">Austin and Stuart 2015</a>)</span>, detailed in the following equation:</p>
<p><span class="math display">\[
IPTW_{Stabilized, ATE} = \frac{X*Pr(X=1)}{e}+\frac{(1-X)*Pr(X=0)}{1-e}
\]</span></p>
<p>Here, the PS is defined as <span class="math inline">\(e = \Pr ({X}=1|{Z}={z})\)</span> and <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span> are the treatment status (0 = Sertralex and 1 = Duloxyn) and observed confunders (gender, age, SES level, and Beck score), respectively.</p>
<p>This models the treatment effect across the entire population likely to receive either Sertralex or Duloxyn. Additional details on causal estimands (ATE/ATT) are provided in Appendix <a href="causal.html#causal">D</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="iptw-application.html#cb1-1" tabindex="-1"></a><span class="co">#Perform weighting</span></span>
<span id="cb1-2"><a href="iptw-application.html#cb1-2" tabindex="-1"></a>W <span class="ot">&lt;-</span> WeightIt<span class="sc">::</span><span class="fu">weightit</span>(TREAT <span class="sc">~</span> AGE <span class="sc">+</span> GENDER <span class="sc">+</span> SOCIO_ECO <span class="sc">+</span> BECK,</span>
<span id="cb1-3"><a href="iptw-application.html#cb1-3" tabindex="-1"></a>                            <span class="at">data =</span> data,</span>
<span id="cb1-4"><a href="iptw-application.html#cb1-4" tabindex="-1"></a>                            <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb1-5"><a href="iptw-application.html#cb1-5" tabindex="-1"></a>                            <span class="at">estimand =</span> <span class="st">&quot;ATE&quot;</span>,</span>
<span id="cb1-6"><a href="iptw-application.html#cb1-6" tabindex="-1"></a>                            <span class="at">stabilize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="iptw-application.html#cb1-7" tabindex="-1"></a>data<span class="sc">$</span>weights <span class="ot">&lt;-</span> W<span class="sc">$</span>weights</span>
<span id="cb1-8"><a href="iptw-application.html#cb1-8" tabindex="-1"></a>data<span class="sc">$</span>ps <span class="ot">&lt;-</span> W<span class="sc">$</span>ps</span></code></pre></div>
</div>
<div id="balance-diagnostics" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Balance Diagnostics<a href="iptw-application.html#balance-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To evaluate balance after weighting, we applied the typical recommendation by using the Standardized Mean Difference (SMD) and checking whether the difference in SMD is less than 0.1 <span class="citation">(<a href="references.html#ref-austin_balance_2009">Austin 2009</a>; <a href="references.html#ref-normand_validating_2001">Normand et al. 2001</a>)</span>. A difference below this threshold indicates that the characteristics of interest are balanced between the groups.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="iptw-application.html#cb2-1" tabindex="-1"></a><span class="fu">love.plot</span>(W, </span>
<span id="cb2-2"><a href="iptw-application.html#cb2-2" tabindex="-1"></a>          <span class="at">binary =</span> <span class="st">&quot;std&quot;</span>, </span>
<span id="cb2-3"><a href="iptw-application.html#cb2-3" tabindex="-1"></a>          <span class="at">thresholds =</span> <span class="fu">c</span>(<span class="at">m =</span> .<span class="dv">1</span>),</span>
<span id="cb2-4"><a href="iptw-application.html#cb2-4" tabindex="-1"></a>          <span class="at">sample.names =</span> <span class="fu">c</span>(<span class="st">&quot;Before weighting&quot;</span>, <span class="st">&quot;After weighting&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/love_plot-1.png" width="672" /></p>
<p>To summarize, a table before and after weighting is also represented according to treatment status.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="iptw-application.html#cb3-1" tabindex="-1"></a><span class="co">#Before weighting</span></span>
<span id="cb3-2"><a href="iptw-application.html#cb3-2" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="iptw-application.html#cb3-3" tabindex="-1"></a>  <span class="fu">select</span>(AGE, GENDER, SOCIO_ECO, BECK, TREAT) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="iptw-application.html#cb3-4" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">by =</span> TREAT, </span>
<span id="cb3-5"><a href="iptw-application.html#cb3-5" tabindex="-1"></a>              <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">&quot;{mean} ({sd})&quot;</span>),</span>
<span id="cb3-6"><a href="iptw-application.html#cb3-6" tabindex="-1"></a>              <span class="at">label =</span> <span class="fu">list</span>(AGE <span class="sc">~</span> <span class="st">&quot;Age (at diagnosis)&quot;</span>,</span>
<span id="cb3-7"><a href="iptw-application.html#cb3-7" tabindex="-1"></a>                           GENDER <span class="sc">~</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb3-8"><a href="iptw-application.html#cb3-8" tabindex="-1"></a>                           SOCIO_ECO <span class="sc">~</span> <span class="st">&quot;SES level (1-5)&quot;</span>,</span>
<span id="cb3-9"><a href="iptw-application.html#cb3-9" tabindex="-1"></a>                           BECK <span class="sc">~</span> <span class="st">&quot;Beck score (0-63)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="iptw-application.html#cb3-10" tabindex="-1"></a>  <span class="fu">add_difference</span>(<span class="at">test =</span> <span class="fu">everything</span>() <span class="sc">~</span> <span class="st">&quot;smd&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="iptw-application.html#cb3-11" tabindex="-1"></a>  <span class="fu">modify_header</span>(label <span class="sc">~</span> <span class="st">&quot;**Variable**&quot;</span>, </span>
<span id="cb3-12"><a href="iptw-application.html#cb3-12" tabindex="-1"></a>                estimate <span class="sc">~</span> <span class="st">&quot;**SMD**&quot;</span>, </span>
<span id="cb3-13"><a href="iptw-application.html#cb3-13" tabindex="-1"></a>                stat_1 <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;**Sertralex (N=&quot;</span>,<span class="fu">nrow</span>(data[<span class="fu">which</span>(data<span class="sc">$</span>TREAT<span class="sc">==</span><span class="st">&quot;Sertralex&quot;</span>),]),<span class="st">&quot;)**&quot;</span>), </span>
<span id="cb3-14"><a href="iptw-application.html#cb3-14" tabindex="-1"></a>                stat_2 <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;**Duloxyn (N=&quot;</span>,<span class="fu">nrow</span>(data[<span class="fu">which</span>(data<span class="sc">$</span>TREAT<span class="sc">==</span><span class="st">&quot;Duloxyn&quot;</span>),]),<span class="st">&quot;)**&quot;</span>))</span>
<span id="cb3-15"><a href="iptw-application.html#cb3-15" tabindex="-1"></a>data_selected <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="iptw-application.html#cb3-16" tabindex="-1"></a>  <span class="fu">select</span>(AGE, GENDER, SOCIO_ECO, BECK, TREAT)</span>
<span id="cb3-17"><a href="iptw-application.html#cb3-17" tabindex="-1"></a></span>
<span id="cb3-18"><a href="iptw-application.html#cb3-18" tabindex="-1"></a><span class="co">#After weighting</span></span>
<span id="cb3-19"><a href="iptw-application.html#cb3-19" tabindex="-1"></a>data_svy <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> data_selected, <span class="at">weights =</span> <span class="sc">~</span>W<span class="sc">$</span>weights)</span>
<span id="cb3-20"><a href="iptw-application.html#cb3-20" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> data_svy <span class="sc">%&gt;%</span></span>
<span id="cb3-21"><a href="iptw-application.html#cb3-21" tabindex="-1"></a>  <span class="fu">tbl_svysummary</span>(<span class="at">by =</span> TREAT, </span>
<span id="cb3-22"><a href="iptw-application.html#cb3-22" tabindex="-1"></a>                 <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">&quot;{mean} ({sd})&quot;</span>),</span>
<span id="cb3-23"><a href="iptw-application.html#cb3-23" tabindex="-1"></a>                 <span class="at">label =</span> <span class="fu">list</span>(AGE <span class="sc">~</span> <span class="st">&quot;Age (at diagnosis)&quot;</span>,</span>
<span id="cb3-24"><a href="iptw-application.html#cb3-24" tabindex="-1"></a>                           GENDER <span class="sc">~</span> <span class="st">&quot;Gender&quot;</span>,</span>
<span id="cb3-25"><a href="iptw-application.html#cb3-25" tabindex="-1"></a>                           SOCIO_ECO <span class="sc">~</span> <span class="st">&quot;SES level (1-5)&quot;</span>,</span>
<span id="cb3-26"><a href="iptw-application.html#cb3-26" tabindex="-1"></a>                           BECK <span class="sc">~</span> <span class="st">&quot;Beck score (0-63)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="iptw-application.html#cb3-27" tabindex="-1"></a>  <span class="fu">add_difference</span>(<span class="at">test =</span> <span class="fu">everything</span>() <span class="sc">~</span> <span class="st">&quot;smd&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="iptw-application.html#cb3-28" tabindex="-1"></a>  <span class="fu">modify_header</span>(label <span class="sc">~</span> <span class="st">&quot;**Variable**&quot;</span>, </span>
<span id="cb3-29"><a href="iptw-application.html#cb3-29" tabindex="-1"></a>                estimate <span class="sc">~</span> <span class="st">&quot;**SMD**&quot;</span>, </span>
<span id="cb3-30"><a href="iptw-application.html#cb3-30" tabindex="-1"></a>                stat_1 <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;**Sertralex (N=&quot;</span>,<span class="fu">round</span>(<span class="fu">ESS</span>(W<span class="sc">$</span>weights[W<span class="sc">$</span>treat<span class="sc">==</span><span class="st">&quot;Sertralex&quot;</span>]),<span class="dv">0</span>),<span class="st">&quot;)**&quot;</span>), </span>
<span id="cb3-31"><a href="iptw-application.html#cb3-31" tabindex="-1"></a>                stat_2 <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;**Duloxyn (N=&quot;</span>,<span class="fu">round</span>(<span class="fu">ESS</span>(W<span class="sc">$</span>weights[W<span class="sc">$</span>treat<span class="sc">==</span><span class="st">&quot;Duloxyn&quot;</span>]),<span class="dv">0</span>),<span class="st">&quot;)**&quot;</span>)) </span>
<span id="cb3-32"><a href="iptw-application.html#cb3-32" tabindex="-1"></a></span>
<span id="cb3-33"><a href="iptw-application.html#cb3-33" tabindex="-1"></a><span class="cf">for</span> (int_col <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;modify_stat_N&quot;</span>, <span class="st">&quot;modify_stat_n&quot;</span>)) {</span>
<span id="cb3-34"><a href="iptw-application.html#cb3-34" tabindex="-1"></a>  t1<span class="sc">$</span>table_styling<span class="sc">$</span>header[[int_col]] <span class="ot">&lt;-</span></span>
<span id="cb3-35"><a href="iptw-application.html#cb3-35" tabindex="-1"></a>    t1<span class="sc">$</span>table_styling<span class="sc">$</span>header[[int_col]] <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb3-36"><a href="iptw-application.html#cb3-36" tabindex="-1"></a>}</span>
<span id="cb3-37"><a href="iptw-application.html#cb3-37" tabindex="-1"></a></span>
<span id="cb3-38"><a href="iptw-application.html#cb3-38" tabindex="-1"></a><span class="fu">tbl_merge</span>(<span class="at">tbls =</span> <span class="fu">list</span>(t1, t2),</span>
<span id="cb3-39"><a href="iptw-application.html#cb3-39" tabindex="-1"></a>          <span class="at">tab_spanner =</span> <span class="fu">c</span>(</span>
<span id="cb3-40"><a href="iptw-application.html#cb3-40" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">&quot;**Raw (N=&quot;</span>,<span class="fu">nrow</span>(data),<span class="st">&quot;)**&quot;</span>), </span>
<span id="cb3-41"><a href="iptw-application.html#cb3-41" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">&quot;**Weighted (ESS=&quot;</span>,<span class="fu">round</span>(<span class="fu">ESS</span>(W<span class="sc">$</span>weights),<span class="dv">0</span>),<span class="st">&quot;)**&quot;</span>)</span>
<span id="cb3-42"><a href="iptw-application.html#cb3-42" tabindex="-1"></a>            )</span>
<span id="cb3-43"><a href="iptw-application.html#cb3-43" tabindex="-1"></a>          )<span class="sc">%&gt;%</span></span>
<span id="cb3-44"><a href="iptw-application.html#cb3-44" tabindex="-1"></a>  <span class="fu">modify_table_body</span>(<span class="sc">~</span> .x <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>conf.low_1, <span class="sc">-</span>conf.low_2))</span></code></pre></div>
<div id="vkyzfdndpd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vkyzfdndpd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vkyzfdndpd thead, #vkyzfdndpd tbody, #vkyzfdndpd tfoot, #vkyzfdndpd tr, #vkyzfdndpd td, #vkyzfdndpd th {
  border-style: none;
}

#vkyzfdndpd p {
  margin: 0;
  padding: 0;
}

#vkyzfdndpd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vkyzfdndpd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vkyzfdndpd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vkyzfdndpd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vkyzfdndpd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vkyzfdndpd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkyzfdndpd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vkyzfdndpd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vkyzfdndpd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vkyzfdndpd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vkyzfdndpd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vkyzfdndpd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vkyzfdndpd .gt_spanner_row {
  border-bottom-style: hidden;
}

#vkyzfdndpd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vkyzfdndpd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vkyzfdndpd .gt_from_md > :first-child {
  margin-top: 0;
}

#vkyzfdndpd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vkyzfdndpd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vkyzfdndpd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyzfdndpd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vkyzfdndpd .gt_row_group_first td {
  border-top-width: 2px;
}

#vkyzfdndpd .gt_row_group_first th {
  border-top-width: 2px;
}

#vkyzfdndpd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyzfdndpd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vkyzfdndpd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vkyzfdndpd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkyzfdndpd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyzfdndpd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vkyzfdndpd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vkyzfdndpd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vkyzfdndpd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkyzfdndpd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vkyzfdndpd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyzfdndpd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vkyzfdndpd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyzfdndpd .gt_left {
  text-align: left;
}

#vkyzfdndpd .gt_center {
  text-align: center;
}

#vkyzfdndpd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vkyzfdndpd .gt_font_normal {
  font-weight: normal;
}

#vkyzfdndpd .gt_font_bold {
  font-weight: bold;
}

#vkyzfdndpd .gt_font_italic {
  font-style: italic;
}

#vkyzfdndpd .gt_super {
  font-size: 65%;
}

#vkyzfdndpd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vkyzfdndpd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vkyzfdndpd .gt_indent_1 {
  text-indent: 5px;
}

#vkyzfdndpd .gt_indent_2 {
  text-indent: 10px;
}

#vkyzfdndpd .gt_indent_3 {
  text-indent: 15px;
}

#vkyzfdndpd .gt_indent_4 {
  text-indent: 20px;
}

#vkyzfdndpd .gt_indent_5 {
  text-indent: 25px;
}

#vkyzfdndpd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vkyzfdndpd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="label"><span class='gt_from_md'><strong>Variable</strong></span></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="**Raw (N=503)**">
        <div class="gt_column_spanner"><span class='gt_from_md'><strong>Raw (N=503)</strong></span></div>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="**Weighted (ESS=367)**">
        <div class="gt_column_spanner"><span class='gt_from_md'><strong>Weighted (ESS=367)</strong></span></div>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_1_1"><span class='gt_from_md'><strong>Sertralex (N=263)</strong></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_2_1"><span class='gt_from_md'><strong>Duloxyn (N=240)</strong></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate_1"><span class='gt_from_md'><strong>SMD</strong></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_2_2"><span class='gt_from_md'><strong>Duloxyn (N=188)</strong></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_1_2"><span class='gt_from_md'><strong>Sertralex (N=181)</strong></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate_2"><span class='gt_from_md'><strong>SMD</strong></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">Age (at diagnosis)</td>
<td headers="stat_1_1" class="gt_row gt_center">32.8 (6.1)</td>
<td headers="stat_2_1" class="gt_row gt_center">31.6 (5.8)</td>
<td headers="estimate_1" class="gt_row gt_center">0.20</td>
<td headers="stat_2_2" class="gt_row gt_center">31.7 (6.6)</td>
<td headers="stat_1_2" class="gt_row gt_center">31.9 (5.6)</td>
<td headers="estimate_2" class="gt_row gt_center">-0.04</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Gender</td>
<td headers="stat_1_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_1" class="gt_row gt_center"><br /></td>
<td headers="estimate_1" class="gt_row gt_center">0.33</td>
<td headers="stat_2_2" class="gt_row gt_center"><br /></td>
<td headers="stat_1_2" class="gt_row gt_center"><br /></td>
<td headers="estimate_2" class="gt_row gt_center">0.04</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Male</td>
<td headers="stat_1_1" class="gt_row gt_center">122 (46%)</td>
<td headers="stat_2_1" class="gt_row gt_center">150 (63%)</td>
<td headers="estimate_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_2" class="gt_row gt_center">152 (56%)</td>
<td headers="stat_1_2" class="gt_row gt_center">130 (55%)</td>
<td headers="estimate_2" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Female</td>
<td headers="stat_1_1" class="gt_row gt_center">141 (54%)</td>
<td headers="stat_2_1" class="gt_row gt_center">90 (38%)</td>
<td headers="estimate_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_2" class="gt_row gt_center">117 (44%)</td>
<td headers="stat_1_2" class="gt_row gt_center">109 (45%)</td>
<td headers="estimate_2" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">SES level (1-5)</td>
<td headers="stat_1_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_1" class="gt_row gt_center"><br /></td>
<td headers="estimate_1" class="gt_row gt_center">0.28</td>
<td headers="stat_2_2" class="gt_row gt_center"><br /></td>
<td headers="stat_1_2" class="gt_row gt_center"><br /></td>
<td headers="estimate_2" class="gt_row gt_center">0.07</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Very low</td>
<td headers="stat_1_1" class="gt_row gt_center">38 (14%)</td>
<td headers="stat_2_1" class="gt_row gt_center">53 (22%)</td>
<td headers="estimate_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_2" class="gt_row gt_center">56 (21%)</td>
<td headers="stat_1_2" class="gt_row gt_center">45 (19%)</td>
<td headers="estimate_2" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Low</td>
<td headers="stat_1_1" class="gt_row gt_center">53 (20%)</td>
<td headers="stat_2_1" class="gt_row gt_center">41 (17%)</td>
<td headers="estimate_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_2" class="gt_row gt_center">50 (18%)</td>
<td headers="stat_1_2" class="gt_row gt_center">49 (20%)</td>
<td headers="estimate_2" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Moderate</td>
<td headers="stat_1_1" class="gt_row gt_center">63 (24%)</td>
<td headers="stat_2_1" class="gt_row gt_center">38 (16%)</td>
<td headers="estimate_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_2" class="gt_row gt_center">54 (20%)</td>
<td headers="stat_1_2" class="gt_row gt_center">46 (19%)</td>
<td headers="estimate_2" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    High</td>
<td headers="stat_1_1" class="gt_row gt_center">58 (22%)</td>
<td headers="stat_2_1" class="gt_row gt_center">51 (21%)</td>
<td headers="estimate_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_2" class="gt_row gt_center">53 (20%)</td>
<td headers="stat_1_2" class="gt_row gt_center">47 (20%)</td>
<td headers="estimate_2" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Very high</td>
<td headers="stat_1_1" class="gt_row gt_center">51 (19%)</td>
<td headers="stat_2_1" class="gt_row gt_center">57 (24%)</td>
<td headers="estimate_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2_2" class="gt_row gt_center">57 (21%)</td>
<td headers="stat_1_2" class="gt_row gt_center">53 (22%)</td>
<td headers="estimate_2" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">Beck score (0-63)</td>
<td headers="stat_1_1" class="gt_row gt_center">24 (7)</td>
<td headers="stat_2_1" class="gt_row gt_center">29 (7)</td>
<td headers="estimate_1" class="gt_row gt_center">-0.67</td>
<td headers="stat_2_2" class="gt_row gt_center">27 (8)</td>
<td headers="stat_1_2" class="gt_row gt_center">26 (8)</td>
<td headers="estimate_2" class="gt_row gt_center">0.07</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="7"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span class='gt_from_md'>Mean (SD); n (%)</span></td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="7"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> <span class='gt_from_md'>Standardized Mean Difference</span></td>
    </tr>
  </tfoot>
</table>
</div>
<p>After weighting, observed confunders were above the recommended threshold. If, after weighting, the observed confounders exceed the recommended threshold, the model can be respecified (e.g. making a continuous variable categorical or dichotomous, including higher order terms or splines of variables, …). Otherwise, variables with remaining imbalance should ideally be adjusted for when modeling the final outcome, using a doubly robust approach (i.e., adjusting for confounders in both the treatment and outcome models) <span class="citation">(<a href="references.html#ref-funk_doubly_2011">Funk et al. 2011</a>; <a href="references.html#ref-garrido_methods_2014">Garrido et al. 2014</a>)</span>.</p>
<p>Next, to ensure that the positivity assumption is met, we plotted the propensity score distributions to assess the degree of overlap between individuals receiving Sertralex and Duloxyn. Our goal is to establish sufficient common support, meaning all subjects have a non-zero probability of receiving either treatment.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="iptw-application.html#cb4-1" tabindex="-1"></a><span class="co">#Display PS</span></span>
<span id="cb4-2"><a href="iptw-application.html#cb4-2" tabindex="-1"></a>plot1<span class="ot">&lt;-</span>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ps))<span class="sc">+</span></span>
<span id="cb4-3"><a href="iptw-application.html#cb4-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-4"><a href="iptw-application.html#cb4-4" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">group =</span> TREAT, <span class="at">fill =</span> TREAT),<span class="at">alpha=</span><span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb4-5"><a href="iptw-application.html#cb4-5" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Raw&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-6"><a href="iptw-application.html#cb4-6" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Treatment&quot;</span>,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Sertralex&quot;</span>,<span class="st">&quot;Duloxyn&quot;</span>),<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFDB6D&quot;</span>,<span class="st">&quot;#00AFBB&quot;</span>))<span class="sc">+</span></span>
<span id="cb4-7"><a href="iptw-application.html#cb4-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Propensity Score (PS)&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-8"><a href="iptw-application.html#cb4-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-9"><a href="iptw-application.html#cb4-9" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb4-10"><a href="iptw-application.html#cb4-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-11"><a href="iptw-application.html#cb4-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb4-12"><a href="iptw-application.html#cb4-12" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="iptw-application.html#cb4-13" tabindex="-1"></a><span class="co">#After weighting</span></span>
<span id="cb4-14"><a href="iptw-application.html#cb4-14" tabindex="-1"></a>plot2<span class="ot">&lt;-</span>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ps, <span class="at">weight =</span> weights))<span class="sc">+</span></span>
<span id="cb4-15"><a href="iptw-application.html#cb4-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-16"><a href="iptw-application.html#cb4-16" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">group =</span> TREAT, <span class="at">fill =</span> TREAT),<span class="at">alpha=</span><span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb4-17"><a href="iptw-application.html#cb4-17" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Weighted&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-18"><a href="iptw-application.html#cb4-18" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Treatment&quot;</span>,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Sertralex&quot;</span>,<span class="st">&quot;Duloxyn&quot;</span>),<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFDB6D&quot;</span>,<span class="st">&quot;#00AFBB&quot;</span>))<span class="sc">+</span></span>
<span id="cb4-19"><a href="iptw-application.html#cb4-19" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Propensity Score (PS)&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-20"><a href="iptw-application.html#cb4-20" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-21"><a href="iptw-application.html#cb4-21" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb4-22"><a href="iptw-application.html#cb4-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">&quot;*the red line indicates the PS distribution for the overall population&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-23"><a href="iptw-application.html#cb4-23" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb4-24"><a href="iptw-application.html#cb4-24" tabindex="-1"></a>  </span>
<span id="cb4-25"><a href="iptw-application.html#cb4-25" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1,plot2,<span class="at">common.legend =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/ps-1.png" width="672" /></p>
<p>We observed that after weighting the two distributions curves align, indicating the dataset is balanced on average.</p>
</div>
<div id="outcome-analysis" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Outcome analysis<a href="iptw-application.html#outcome-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section details the outcome analyis. First, unadjusted and weighted Kaplan-Meier curves <span class="citation">(<a href="references.html#ref-cole_adjusted_2004">Cole and Hernán 2004</a>)</span>, stratified on treatment group, are compared.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="iptw-application.html#cb5-1" tabindex="-1"></a><span class="co">#Implement unadjusted model</span></span>
<span id="cb5-2"><a href="iptw-application.html#cb5-2" tabindex="-1"></a>unadjusted<span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(TIME_TO_EVENT, EVENT)<span class="sc">~</span>TREAT, <span class="at">data =</span> data)</span>
<span id="cb5-3"><a href="iptw-application.html#cb5-3" tabindex="-1"></a><span class="co">#Implement IPTW adjusted model</span></span>
<span id="cb5-4"><a href="iptw-application.html#cb5-4" tabindex="-1"></a>weighted<span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(TIME_TO_EVENT, EVENT)<span class="sc">~</span>TREAT, <span class="at">data =</span> data, <span class="at">weights =</span> weights)</span>
<span id="cb5-5"><a href="iptw-application.html#cb5-5" tabindex="-1"></a><span class="co">#Combine both</span></span>
<span id="cb5-6"><a href="iptw-application.html#cb5-6" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">list</span>(unadjusted,weighted)</span>
<span id="cb5-7"><a href="iptw-application.html#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="iptw-application.html#cb5-8" tabindex="-1"></a><span class="co"># Function to format survival probabilities at a given time point</span></span>
<span id="cb5-9"><a href="iptw-application.html#cb5-9" tabindex="-1"></a>format_median_time <span class="ot">&lt;-</span> <span class="cf">function</span>(surv_object, treatment_index) {</span>
<span id="cb5-10"><a href="iptw-application.html#cb5-10" tabindex="-1"></a>  </span>
<span id="cb5-11"><a href="iptw-application.html#cb5-11" tabindex="-1"></a>  <span class="co"># Extract the median survival time for the given treatment index</span></span>
<span id="cb5-12"><a href="iptw-application.html#cb5-12" tabindex="-1"></a>  median_surv <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(surv_object)<span class="sc">$</span>table[treatment_index, <span class="st">&quot;median&quot;</span>], <span class="dv">2</span>))</span>
<span id="cb5-13"><a href="iptw-application.html#cb5-13" tabindex="-1"></a>  lower_ci <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(surv_object)<span class="sc">$</span>table[treatment_index, <span class="st">&quot;0.95LCL&quot;</span>], <span class="dv">2</span>))</span>
<span id="cb5-14"><a href="iptw-application.html#cb5-14" tabindex="-1"></a>  upper_ci <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(surv_object)<span class="sc">$</span>table[treatment_index, <span class="st">&quot;0.95UCL&quot;</span>], <span class="dv">2</span>))</span>
<span id="cb5-15"><a href="iptw-application.html#cb5-15" tabindex="-1"></a>  </span>
<span id="cb5-16"><a href="iptw-application.html#cb5-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">paste0</span>(median_surv, <span class="st">&quot; [&quot;</span>, lower_ci, <span class="st">&quot;; &quot;</span>, upper_ci, <span class="st">&quot;]&quot;</span>))</span>
<span id="cb5-17"><a href="iptw-application.html#cb5-17" tabindex="-1"></a>  </span>
<span id="cb5-18"><a href="iptw-application.html#cb5-18" tabindex="-1"></a>}</span>
<span id="cb5-19"><a href="iptw-application.html#cb5-19" tabindex="-1"></a></span>
<span id="cb5-20"><a href="iptw-application.html#cb5-20" tabindex="-1"></a><span class="co"># Usage for raw and IPTW median time</span></span>
<span id="cb5-21"><a href="iptw-application.html#cb5-21" tabindex="-1"></a>unadjusted_treatment_0 <span class="ot">&lt;-</span> <span class="fu">format_median_time</span>(unadjusted, <span class="dv">1</span>)</span>
<span id="cb5-22"><a href="iptw-application.html#cb5-22" tabindex="-1"></a>unadjusted_treatment_1 <span class="ot">&lt;-</span> <span class="fu">format_median_time</span>(unadjusted, <span class="dv">2</span>)</span>
<span id="cb5-23"><a href="iptw-application.html#cb5-23" tabindex="-1"></a>weighted_treatment_0 <span class="ot">&lt;-</span> <span class="fu">format_median_time</span>(weighted, <span class="dv">1</span>)</span>
<span id="cb5-24"><a href="iptw-application.html#cb5-24" tabindex="-1"></a>weighted_treatment_1 <span class="ot">&lt;-</span> <span class="fu">format_median_time</span>(weighted, <span class="dv">2</span>)</span>
<span id="cb5-25"><a href="iptw-application.html#cb5-25" tabindex="-1"></a></span>
<span id="cb5-26"><a href="iptw-application.html#cb5-26" tabindex="-1"></a><span class="fu">ggsurvplot_combine</span>(fit, </span>
<span id="cb5-27"><a href="iptw-application.html#cb5-27" tabindex="-1"></a>                   <span class="at">data =</span> data,</span>
<span id="cb5-28"><a href="iptw-application.html#cb5-28" tabindex="-1"></a>                   <span class="at">legend.title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb5-29"><a href="iptw-application.html#cb5-29" tabindex="-1"></a>                   <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">&quot;Unadjusted: Sertralex&quot;</span>, </span>
<span id="cb5-30"><a href="iptw-application.html#cb5-30" tabindex="-1"></a>                                   <span class="st">&quot;Unadjusted: Duloxyn&quot;</span>,</span>
<span id="cb5-31"><a href="iptw-application.html#cb5-31" tabindex="-1"></a>                                   <span class="st">&quot;Weighted: Sertralex&quot;</span>, </span>
<span id="cb5-32"><a href="iptw-application.html#cb5-32" tabindex="-1"></a>                                   <span class="st">&quot;Weighted: Duloxyn&quot;</span>),</span>
<span id="cb5-33"><a href="iptw-application.html#cb5-33" tabindex="-1"></a>                   <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#ff331a&quot;</span>,<span class="st">&quot;#ff80a6&quot;</span>,<span class="st">&quot;#FFDB6D&quot;</span>,<span class="st">&quot;#27d4ad&quot;</span>),</span>
<span id="cb5-34"><a href="iptw-application.html#cb5-34" tabindex="-1"></a>                   <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-35"><a href="iptw-application.html#cb5-35" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">&quot;Time (in days)&quot;</span>,</span>
<span id="cb5-36"><a href="iptw-application.html#cb5-36" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/km-1.png" width="672" /></p>
<p>As outlined, the median time to relapse differs depending on the analysis and treatment group considered. In the unadjusted analysis, we observed a median survival time of 84.00 [70.00; 99.00] days for Sertralex, compared to 45.00 [39.00; 57.00] days for Duloxyn. In the weighted analysis (where weights are used to create a pseudo population), these differences were reduced, median survival time of 58.00 [48.00; 73.00] days for Sertralex and 64.00 [52.00; 95.00] days for Duloxyn.</p>
<p>Second, unadjusted, multivariable, and weighted Cox are displayed.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="iptw-application.html#cb6-1" tabindex="-1"></a><span class="co"># Fit the Cox models</span></span>
<span id="cb6-2"><a href="iptw-application.html#cb6-2" tabindex="-1"></a>unadjusted <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(TIME_TO_EVENT, EVENT) <span class="sc">~</span> TREAT, <span class="at">data =</span> data)</span>
<span id="cb6-3"><a href="iptw-application.html#cb6-3" tabindex="-1"></a>multivariable <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(TIME_TO_EVENT, EVENT) <span class="sc">~</span> TREAT <span class="sc">+</span> AGE <span class="sc">+</span> GENDER <span class="sc">+</span> SOCIO_ECO <span class="sc">+</span> BECK, <span class="at">data =</span> data)</span>
<span id="cb6-4"><a href="iptw-application.html#cb6-4" tabindex="-1"></a>weighted <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(TIME_TO_EVENT, EVENT) <span class="sc">~</span> TREAT, <span class="at">weights =</span> weights, <span class="at">data =</span> data)</span>
<span id="cb6-5"><a href="iptw-application.html#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="iptw-application.html#cb6-6" tabindex="-1"></a><span class="co"># Create regression tables</span></span>
<span id="cb6-7"><a href="iptw-application.html#cb6-7" tabindex="-1"></a>unadjusted_table <span class="ot">&lt;-</span> unadjusted <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="iptw-application.html#cb6-8" tabindex="-1"></a>  <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-9"><a href="iptw-application.html#cb6-9" tabindex="-1"></a>                 <span class="at">label =</span> <span class="fu">list</span>(TREAT <span class="sc">~</span> <span class="st">&quot;Treatment (unadjusted)&quot;</span>))</span>
<span id="cb6-10"><a href="iptw-application.html#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="iptw-application.html#cb6-11" tabindex="-1"></a>multivariable_table <span class="ot">&lt;-</span> multivariable <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="iptw-application.html#cb6-12" tabindex="-1"></a>  <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-13"><a href="iptw-application.html#cb6-13" tabindex="-1"></a>                 <span class="at">label =</span> <span class="fu">list</span>(TREAT <span class="sc">~</span> <span class="st">&quot;Treatment (multivariable regression)&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="iptw-application.html#cb6-14" tabindex="-1"></a>  <span class="fu">modify_table_body</span>(</span>
<span id="cb6-15"><a href="iptw-application.html#cb6-15" tabindex="-1"></a>    <span class="sc">~</span> .x <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">&quot;TREAT&quot;</span>)</span>
<span id="cb6-16"><a href="iptw-application.html#cb6-16" tabindex="-1"></a>  )</span>
<span id="cb6-17"><a href="iptw-application.html#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="iptw-application.html#cb6-18" tabindex="-1"></a>weighted_table <span class="ot">&lt;-</span> weighted <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="iptw-application.html#cb6-19" tabindex="-1"></a>  <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-20"><a href="iptw-application.html#cb6-20" tabindex="-1"></a>                 <span class="at">label =</span> <span class="fu">list</span>(TREAT <span class="sc">~</span> <span class="st">&quot;Treatment (weighted)&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="iptw-application.html#cb6-21" tabindex="-1"></a>  <span class="fu">modify_table_body</span>(</span>
<span id="cb6-22"><a href="iptw-application.html#cb6-22" tabindex="-1"></a>    <span class="sc">~</span> .x <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">&quot;TREAT&quot;</span>)</span>
<span id="cb6-23"><a href="iptw-application.html#cb6-23" tabindex="-1"></a>  )</span>
<span id="cb6-24"><a href="iptw-application.html#cb6-24" tabindex="-1"></a></span>
<span id="cb6-25"><a href="iptw-application.html#cb6-25" tabindex="-1"></a><span class="co"># Function to extract HR and CI for a specific variable</span></span>
<span id="cb6-26"><a href="iptw-application.html#cb6-26" tabindex="-1"></a>extract_hr_ci <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb6-27"><a href="iptw-application.html#cb6-27" tabindex="-1"></a>  conf <span class="ot">&lt;-</span> <span class="fu">confint</span>(model)</span>
<span id="cb6-28"><a href="iptw-application.html#cb6-28" tabindex="-1"></a>  hr <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="fu">exp</span>(model<span class="sc">$</span>coefficients)[<span class="dv">1</span>])</span>
<span id="cb6-29"><a href="iptw-application.html#cb6-29" tabindex="-1"></a>  ci_lower <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="fu">exp</span>(conf)[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb6-30"><a href="iptw-application.html#cb6-30" tabindex="-1"></a>  ci_upper <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="fu">exp</span>(conf)[<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb6-31"><a href="iptw-application.html#cb6-31" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">paste0</span>(<span class="st">&quot;HR = &quot;</span>, hr, <span class="st">&quot; [&quot;</span>, ci_lower, <span class="st">&quot;; &quot;</span>, ci_upper, <span class="st">&quot;]&quot;</span>))</span>
<span id="cb6-32"><a href="iptw-application.html#cb6-32" tabindex="-1"></a>}</span>
<span id="cb6-33"><a href="iptw-application.html#cb6-33" tabindex="-1"></a></span>
<span id="cb6-34"><a href="iptw-application.html#cb6-34" tabindex="-1"></a><span class="co"># Extract and format HR and CI for TREAT</span></span>
<span id="cb6-35"><a href="iptw-application.html#cb6-35" tabindex="-1"></a>unadjusted_hr_ci <span class="ot">&lt;-</span> <span class="fu">extract_hr_ci</span>(unadjusted)</span>
<span id="cb6-36"><a href="iptw-application.html#cb6-36" tabindex="-1"></a>multivariable_hr_ci <span class="ot">&lt;-</span> <span class="fu">extract_hr_ci</span>(multivariable)</span>
<span id="cb6-37"><a href="iptw-application.html#cb6-37" tabindex="-1"></a>weighted_hr_ci <span class="ot">&lt;-</span> <span class="fu">extract_hr_ci</span>(weighted)</span>
<span id="cb6-38"><a href="iptw-application.html#cb6-38" tabindex="-1"></a></span>
<span id="cb6-39"><a href="iptw-application.html#cb6-39" tabindex="-1"></a><span class="co"># Stack the regression tables</span></span>
<span id="cb6-40"><a href="iptw-application.html#cb6-40" tabindex="-1"></a><span class="fu">tbl_stack</span>(<span class="fu">list</span>(unadjusted_table, multivariable_table, weighted_table))</span></code></pre></div>
<div id="pdyvogezgd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pdyvogezgd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pdyvogezgd thead, #pdyvogezgd tbody, #pdyvogezgd tfoot, #pdyvogezgd tr, #pdyvogezgd td, #pdyvogezgd th {
  border-style: none;
}

#pdyvogezgd p {
  margin: 0;
  padding: 0;
}

#pdyvogezgd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pdyvogezgd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pdyvogezgd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pdyvogezgd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pdyvogezgd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pdyvogezgd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pdyvogezgd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pdyvogezgd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pdyvogezgd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pdyvogezgd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pdyvogezgd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pdyvogezgd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pdyvogezgd .gt_spanner_row {
  border-bottom-style: hidden;
}

#pdyvogezgd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pdyvogezgd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pdyvogezgd .gt_from_md > :first-child {
  margin-top: 0;
}

#pdyvogezgd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pdyvogezgd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pdyvogezgd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pdyvogezgd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pdyvogezgd .gt_row_group_first td {
  border-top-width: 2px;
}

#pdyvogezgd .gt_row_group_first th {
  border-top-width: 2px;
}

#pdyvogezgd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pdyvogezgd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pdyvogezgd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pdyvogezgd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pdyvogezgd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pdyvogezgd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pdyvogezgd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pdyvogezgd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pdyvogezgd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pdyvogezgd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pdyvogezgd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pdyvogezgd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pdyvogezgd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pdyvogezgd .gt_left {
  text-align: left;
}

#pdyvogezgd .gt_center {
  text-align: center;
}

#pdyvogezgd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pdyvogezgd .gt_font_normal {
  font-weight: normal;
}

#pdyvogezgd .gt_font_bold {
  font-weight: bold;
}

#pdyvogezgd .gt_font_italic {
  font-style: italic;
}

#pdyvogezgd .gt_super {
  font-size: 65%;
}

#pdyvogezgd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pdyvogezgd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pdyvogezgd .gt_indent_1 {
  text-indent: 5px;
}

#pdyvogezgd .gt_indent_2 {
  text-indent: 10px;
}

#pdyvogezgd .gt_indent_3 {
  text-indent: 15px;
}

#pdyvogezgd .gt_indent_4 {
  text-indent: 20px;
}

#pdyvogezgd .gt_indent_5 {
  text-indent: 25px;
}

#pdyvogezgd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pdyvogezgd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span class='gt_from_md'><strong>Characteristic</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span class='gt_from_md'><strong>HR</strong></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span class='gt_from_md'><strong>95% CI</strong></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span class='gt_from_md'><strong>p-value</strong></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">Treatment (unadjusted)</td>
<td headers="estimate" class="gt_row gt_center"><br /></td>
<td headers="conf.low" class="gt_row gt_center"><br /></td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Sertralex</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="conf.low" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Duloxyn</td>
<td headers="estimate" class="gt_row gt_center">1.50</td>
<td headers="conf.low" class="gt_row gt_center">1.24, 1.81</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Treatment (multivariable regression)</td>
<td headers="estimate" class="gt_row gt_center"><br /></td>
<td headers="conf.low" class="gt_row gt_center"><br /></td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Sertralex</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="conf.low" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Duloxyn</td>
<td headers="estimate" class="gt_row gt_center">0.74</td>
<td headers="conf.low" class="gt_row gt_center">0.60, 0.91</td>
<td headers="p.value" class="gt_row gt_center">0.004</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Treatment (weighted)</td>
<td headers="estimate" class="gt_row gt_center"><br /></td>
<td headers="conf.low" class="gt_row gt_center"><br /></td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Sertralex</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="conf.low" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Duloxyn</td>
<td headers="estimate" class="gt_row gt_center">0.84</td>
<td headers="conf.low" class="gt_row gt_center">0.66, 1.06</td>
<td headers="p.value" class="gt_row gt_center">0.14</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span class='gt_from_md'>HR = Hazard Ratio, CI = Confidence Interval</span></td>
    </tr>
  </tfoot>
</table>
</div>
<p>As shown, the treatment effect varies depending on the analysis and treatment group considered. In the raw analysis, the HR = 1.50 [1.24; 1.81], suggesting that Duloxyn significantly increases the risk of relapse. Conversely, the multivariate model and IPTW analyses yielded an HR = 0.74 [0.60; 0.91], and HR = 0.84 [0.66; 1.06], respectively, indicating not statistically significant findings. Lastly, the slight differences between the multivariate and IPTW models highlight that conditional and marginal effects are not equivalent.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="target-trial-emulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="clone-censor-weight.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false,
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
